This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2024-12-21T21:49:42.262Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repomix, visit: https://github.com/yamadashy/repomix

================================================================
Repository Structure
================================================================
airflow/
  dags/
    sync_bea_dags.py
  packages/
    database_util.py
    sync_bea.py
  airflow.Dockerfile
  requirements.txt
dbt/
  econdash/
    macros/
      debug.sql
      generate_sources_macro.sql
      generate_sources_template.sql
    models/
      base_fixedassets.sql
      base_nipa.sql
      base_underlyingasset.sql
      bea_datasets_metadata.sql
      sources.yml
    .gitignore
    dbt_project.yml
    README.md
  .user.yml
  profiles.yml
scripts/
  write_dbt_metadata_table.py
  write_sources.py
web/
  app.py
  Dockerfile
  requirements.txt
docker-compose.yaml
Makefile
README.md

================================================================
Repository Files
================================================================

================
File: airflow/dags/sync_bea_dags.py
================
from airflow import DAG
from airflow.operators.bash import BashOperator
from airflow.operators.python_operator import PythonOperator
from datetime import datetime, timedelta
import os
import sys

# Add the directory containing sync_bea.py to the Python path
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'packages')))

from sync_bea import BEAApiClient
from database_util import PostgresDatabase

# Default arguments
default_args = {
    'owner': 'airflow',
    'depends_on_past': False,
    'email_on_failure': False,
    'email_on_retry': False,
    'retries': 1,
    'retry_delay': timedelta(minutes=5),
}

# Define the DAG
dag = DAG(
    'sync_bea_dag',
    default_args=default_args,
    description='A DAG to sync BEA data and run dbt tasks',
    schedule_interval=timedelta(days=1),
    start_date=datetime(2023, 5, 14),
    catchup=False,
)

def sync_bea():
    api_key = os.getenv('BEA_API_KEY')
    db_instance = PostgresDatabase(
        host=os.getenv('POSTGRES_HOST'),
        port=int(os.getenv('POSTGRES_PORT')),
        database=os.getenv('POSTGRES_DB'),
        user=os.getenv('POSTGRES_USER'),
        password=os.getenv('POSTGRES_PASSWORD')
    )
    bea_client = BEAApiClient(api_key, db_instance)
    bea_client.sync_datasets()

# Define the sync task
sync_bea_task = PythonOperator(
    task_id='sync_bea',
    python_callable=sync_bea,
    dag=dag,
)

# Define dbt tasks
dbt_run = BashOperator(
    task_id='dbt_run',
    bash_command='/home/airflow/.local/bin/dbt run --project-dir /opt/dbt/econdash --profiles-dir /opt/dbt',
    dag=dag
)

dbt_test = BashOperator(
    task_id='dbt_test',
    bash_command='/home/airflow/.local/bin/dbt test --project-dir /opt/dbt/econdash --profiles-dir /opt/dbt',
    dag=dag
)

# Set dependencies
sync_bea_task >> dbt_run >> dbt_test

================
File: airflow/packages/database_util.py
================
from sqlalchemy import create_engine, text
from sqlalchemy.exc import SQLAlchemyError
import pandas as pd
import logging
import sqlalchemy
import psycopg2
from io import StringIO

# Configure logging
logging.basicConfig(
    level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s"
)


class PostgresDatabase:
    """
    Simple class to interact with Postgres database
    """

    def __init__(self, host, port, database, user, password):
        self.host = host
        self.port = port
        self.database = database
        self.user = user
        self.password = password
        self.engine = self._create_engine()

    def _create_engine(self):
        logging.info(
            f"Creating SQLAlchemy engine for database: {self.database} on host: {self.host}:{self.port}"
        )
        engine = create_engine(
            f"postgresql://{self.user}:{self.password}@{self.host}:{self.port}/{self.database}"
        )
        logging.info(f"SQLAlchemy engine created successfully")
        return engine

    def fetch_data(self, query):
        with self.engine.connect() as conn:
            return pd.read_sql(query, conn)

    def execute_query(self, query):
        with self.engine.connect() as conn:
            conn.execute(text(query))

    def insert_data(self, df, table_name, schema_name, if_exists="replace"):
        """
        DEPRECATED:

        This doesnt work on airflow - airflow only supports sqlalchemy 1.4.5 and pandas needs 2.0
        Have to use insert_data_with_copy instead on airflow
        """
        self.create_schema(schema_name)
        df.to_sql(
            table_name,
            con=self.engine,
            index=False,
            if_exists=if_exists,
            schema=schema_name,
        )

    def insert_data_with_copy(self, df, table_name, schema_name, if_exists="replace"):
        self.create_schema(schema_name)
        self.create_table_if_not_exists(df, table_name, schema_name)

        # Create a temporary CSV file in memory
        buffer = StringIO()
        df.to_csv(buffer, index=False, header=False)
        buffer.seek(0)

        # Connect to the database using psycopg2
        conn = psycopg2.connect(
            host=self.host,
            port=self.port,
            database=self.database,
            user=self.user,
            password=self.password,
        )

        cursor = conn.cursor()
        try:
            cursor.execute(f"SET search_path TO {schema_name};")

            if if_exists == "replace":
                cursor.execute(f"TRUNCATE TABLE {schema_name}.{table_name};")

            copy_sql = f"COPY {table_name} FROM stdin WITH CSV"
            cursor.copy_expert(copy_sql, buffer)
            conn.commit()
            logging.info(f"Data inserted successfully into {schema_name}.{table_name}")
        except Exception as e:
            conn.rollback()
            logging.error(
                f"Error inserting data into {schema_name}.{table_name}: {str(e)}"
            )
            raise
        finally:
            cursor.close()
            conn.close()

    def create_table_if_not_exists(self, df, table_name, schema_name):
        column_definitions = ", ".join(
            [f"{col} {self.get_postgres_type(df[col])}" for col in df.columns]
        )
        create_table_sql = f"""
        CREATE TABLE IF NOT EXISTS {schema_name}.{table_name} (
            {column_definitions}
        );
        """
        with self.engine.connect() as conn:
            try:
                conn.execute(text(create_table_sql))
                logging.info(
                    f"Table '{schema_name}.{table_name}' created successfully or already exists."
                )
            except SQLAlchemyError as e:
                logging.error(
                    f"Error creating table '{schema_name}.{table_name}': {str(e)}"
                )
                raise

    def get_postgres_type(self, pd_series):
        if pd.api.types.is_integer_dtype(pd_series):
            return "INTEGER"
        elif pd.api.types.is_float_dtype(pd_series):
            return "FLOAT"
        elif pd.api.types.is_bool_dtype(pd_series):
            return "BOOLEAN"
        elif pd.api.types.is_datetime64_any_dtype(pd_series):
            return "TIMESTAMP"
        else:
            return "TEXT"

    def create_schema(self, schema_name):
        with self.engine.connect() as conn:
            sql_command = text(f"CREATE SCHEMA IF NOT EXISTS {schema_name}")
            try:
                conn.execute(sql_command)
                logging.info(
                    f"Schema '{schema_name}' created successfully or already exists."
                )
            except SQLAlchemyError as e:
                logging.error(f"Error creating schema '{schema_name}': {str(e)}")
                raise

================
File: airflow/packages/sync_bea.py
================
import os
import requests
import pandas as pd
import time
import logging
from datetime import datetime
from database_util import PostgresDatabase
import yaml

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# Use an absolute path for the YAML config file
YAML_FILE_PATH = '/opt/airflow/stream_configs/bea_config.yml'
# YAML_FILE_PATH='/Users/glennharless/dev/EconDash/airflow/stream_configs/bea_config.yml'

class BEAApiClient:
    def __init__(self, api_key, db_instance):
        self.base_url = "https://apps.bea.gov/api/data"
        self.api_key = api_key
        self.db = db_instance  # Instance of PostgresDatabase
        self.request_count = 0
        self.load_config(YAML_FILE_PATH)

    def load_config(self, filepath):
        with open(filepath, 'r') as file:
            self.configs = yaml.safe_load(file)['bea_datasets']

    def get_parameter_list(self, dataset_name, result_format="JSON"):
        """Retrieves a list of parameters for a specific dataset from the BEA API."""
        params = {
            'UserID': self.api_key,
            'method': 'getparameterlist',
            'datasetname': dataset_name,
            'ResultFormat': result_format
        }
        response = requests.get(self.base_url, params=params)
        if response.status_code != 200:
            logging.error(f"Failed to retrieve parameters for {dataset_name}: {response.text}")
            return None
        return response.json()

    def get_parameter_values(self, dataset_name, parameter_name, result_format="JSON"):
        """Retrieves valid values for a specific parameter of a dataset."""
        params = {
            'UserID': self.api_key,
            'method': 'GetParameterValues',
            'datasetname': dataset_name,
            'ParameterName': parameter_name,
            'ResultFormat': result_format
        }
        response = requests.get(self.base_url, params=params)
        if response.status_code != 200:
            logging.error(f"Failed to retrieve parameter values for {dataset_name}: {response.text}")
            return None
        return response.json()
    
    def fetch_all_dataset_parameters(self):
        """Fetch parameters for all datasets and store them in self.params."""
        for dataset in self.configs:
            logging.info(f"Fetching parameters for {dataset['DatasetName']}")
            param_data = self.get_parameter_list(dataset['DatasetName'])
            if param_data:
                self.params.append({
                    'DatasetName': dataset['DatasetName'],
                    'Parameters': param_data
                })
            else:
                logging.warning(f"No parameters found for {dataset['DatasetName']}")

    def fetch_valid_table_names(self):
        """Fetch and display valid table names for datasets that include 'TableName' as a parameter."""
        table_names = {}
        for dataset in self.configs:
            for param in dataset['Parameters']['BEAAPI']['Results']['Parameter']:
                if param['ParameterName'] == 'TableName':
                    result = self.get_parameter_values(dataset['DatasetName'], 'TableName')
                    if result:
                        table_names[dataset['DatasetName']] = result
                    else:
                        table_names[dataset['DatasetName']] = 'No valid table names found'
        return table_names
    
    def determine_frequency(self, description):
        """
        We are defaulting to annual frequency to get smoother data and do more of a POC for the last 50 years
        of financial dominance. We can add more logic to determine frequency based on the description.
        """
        return 'A'  # Default to annual if no specific frequency is found

    def check_rate_limit(self):
        # Assuming a limit of 100 requests per minute
        if self.request_count >= 100:
            logging.info("Rate limit approached, pausing for 60 seconds.")
            time.sleep(60)
            self.request_count = 0

    def get_data(self, config, result_format="JSON"):
        current_year = datetime.now().year
        start_year = current_year - 50  # Retrieve data for the last 50 years
        year_range = ','.join(str(year) for year in range(start_year, current_year + 1))

        params = {
            'UserID': self.api_key,
            'method': 'GetData',
            'DataSetName': config['dataset_name'],
            'TableName': config['table_name'],
            'Frequency': config['frequency'],
            'Year': year_range,
            'ResultFormat': result_format
        }

        params.update(config.get('additional_params', {}))

        self.check_rate_limit()
        response = requests.get(self.base_url, params=params)
        self.request_count += 1

        if response.status_code == 429:
            retry_after = int(response.headers.get('Retry-After', 3600))
            if retry_after < 0:
                retry_after = 10
            logging.warning("Rate limit exceeded. Pausing for {} seconds.".format(retry_after))
            time.sleep(retry_after)
            return self.get_data(config, result_format)

        if response.status_code != 200:
            logging.error(f"API Error: {response.json()}")
            return None

        return response.json()

    def sync_datasets(self):
        for dataset in self.configs:
            dataset_name = dataset['name']
            for table in dataset['api']['tables']:
                table_name = table['table_name']
                frequency = self.determine_frequency(table['description'])
                config = {
                    'dataset_name': dataset_name,
                    'table_name': table_name,
                    'frequency': frequency,
                    'additional_params': {}  # Add other parameters as needed
                }
                if dataset_name == 'Regional':
                    config['additional_params']['GeoFips'] = ['STATE']
                logging.info(f"Retrieving data for {dataset_name} with table {table_name} at {frequency} frequency")
                data = self.get_data(config)
                try:
                    if data and 'Data' in data['BEAAPI']['Results']:
                        self.load_into_postgres(data, dataset_name, table_name)
                    else:
                        logging.warning(f"No data or error returned for {dataset_name}")
                except Exception as e:
                    logging.info(f"Error loading data into Postgres: {e}")
                    logging.info(data['BEAAPI']['Error'])

    def load_into_postgres(self, data, dataset_name, table_name):
        df = pd.DataFrame(data['BEAAPI']['Results']['Data'])
        table_name = f'{dataset_name}_{table_name}'.lower()  # Ensure lower case
        self.db.insert_data_with_copy(df, table_name, 'bea', if_exists='replace')

if __name__ == "__main__":
    api_key = os.getenv('BEA_API_KEY')
    db_instance = PostgresDatabase(
        host=os.getenv('POSTGRES_HOST'),
        port=int(os.getenv('POSTGRES_PORT')),
        database=os.getenv('POSTGRES_DB'),
        user=os.getenv('POSTGRES_USER'),
        password=os.getenv('POSTGRES_PASSWORD')
    )
    bea_client = BEAApiClient(api_key, db_instance)
    bea_client.sync_datasets()

================
File: airflow/airflow.Dockerfile
================
# Start with the official Airflow image
FROM apache/airflow:slim-latest-python3.9

USER root

# Install system packages required for Python C extensions
RUN apt-get update && apt-get install -y \
    libpq-dev \
    gcc \
    python3-dev \
    && rm -rf /var/lib/apt/lists/*

USER airflow

# Copy the requirements.txt file into the image
COPY requirements.txt /requirements.txt

# Install Python dependencies
RUN pip install --no-cache-dir -r /requirements.txt

================
File: airflow/requirements.txt
================
pandas==2.2.2
numpy==1.26.4
SQLAlchemy==1.4.52
# SQLAlchemy==2.0.30
psycopg2-binary==2.9.9
scikit-learn==1.4.2
matplotlib==3.8.4
matplotlib-inline==0.1.7
seaborn==0.13.2
notebook==7.1.3
statsmodels==0.14.2
dbt-postgres==1.8.0
apache-airflow-providers-celery>=3.3.0
python-dotenv==1.0.1

================
File: dbt/econdash/macros/debug.sql
================
{% macro debug_print(sql_query) %}
    {% set schema_name = target.schema %}
    {% do run_query("create schema if not exists " ~ schema_name) %}
    {% do run_query("create table if not exists " ~ schema_name ~ ".temp_sql_debug (query text)") %}
    {% do run_query("insert into " ~ schema_name ~ ".temp_sql_debug (query) values ('" ~ sql_query ~ "')") %}
{% endmacro %}

================
File: dbt/econdash/macros/generate_sources_macro.sql
================
{% macro generate_sources(bea_datasets) %}
version: 2

sources:
  - name: bea
    tables:
      {%- for dataset in bea_datasets %}
        {%- if dataset.api.tables is defined and dataset.api.tables %}
          {%- for table in dataset.api.tables %}
          - name: {{ dataset.name }}_{{ table.table_name }}
            description: "{{ table.description }}"
          {%- endfor %}
        {%- else %}
          # Dataset {{ dataset.name }} has no tables
        {%- endif %}
      {%- endfor %}
{% endmacro %}

================
File: dbt/econdash/macros/generate_sources_template.sql
================
{% from 'generate_sources_macro.sql' import generate_sources %}
{{ generate_sources(bea_datasets) }}

================
File: dbt/econdash/models/base_fixedassets.sql
================
-- fixed_assets_base_model.sql

{% set tables_query %}
    select table_name
    from information_schema.tables
    where table_schema = 'bea'
    and table_name like 'fixedassets_%'
{% endset %}

{% set tables = run_query(tables_query) %}

{% if execute %}
    {% set tables_list = tables.columns[0].values() %}
{% else %}
    {% set tables_list = [] %}
{% endif %}

{% if tables_list | length == 0 %}
    -- If no tables are found, return an empty result set
    select null as table_name, null as TableName, null as SeriesCode, null as LineNumber, null as LineDescription, null as TimePeriod, null as METRIC_NAME, null as CL_UNIT, null as UNIT_MULT, null as DataValue, null as NoteRef
    where false
{% else %}
    {% for table_name in tables_list %}
        select
          '{{ table_name }}' as table_name,
          tablename,
            seriescode,
            linenumber,
            linedescription,
            timeperiod,
            metric_name,
            cl_unit,
            unit_mult,
            datavalue,
            noteref
        from {{ source('bea', table_name) }}

        {% if not loop.last %}
        union all
        {% endif %}
    {% endfor %}
{% endif %}

================
File: dbt/econdash/models/base_nipa.sql
================
-- fixed_assets_base_model.sql

{% set tables_query %}
    select table_name
    from information_schema.tables
    where table_schema = 'bea'
    and table_name like 'nipa_%'
{% endset %}

{% set tables = run_query(tables_query) %}

{% if execute %}
    {% set tables_list = tables.columns[0].values() %}
{% else %}
    {% set tables_list = [] %}
{% endif %}

{% if tables_list | length == 0 %}
    -- If no tables are found, return an empty result set
    select null as table_name, null as TableName, null as SeriesCode, null as LineNumber, null as LineDescription, null as TimePeriod, null as METRIC_NAME, null as CL_UNIT, null as UNIT_MULT, null as DataValue, null as NoteRef
    where false
{% else %}
    {% for table_name in tables_list %}
        select
          '{{ table_name }}' as table_name,
          tablename,
            seriescode,
            linenumber,
            linedescription,
            timeperiod,
            metric_name,
            cl_unit,
            unit_mult,
            datavalue,
            noteref
        from {{ source('bea', table_name) }}

        {% if not loop.last %}
        union all
        {% endif %}
    {% endfor %}
{% endif %}

================
File: dbt/econdash/models/base_underlyingasset.sql
================
-- fixed_assets_base_model.sql

{% set tables_query %}
    select table_name
    from information_schema.tables
    where table_schema = 'bea'
    and table_name like 'niunderlyin%'
{% endset %}

{% set tables = run_query(tables_query) %}

{% if execute %}
    {% set tables_list = tables.columns[0].values() %}
{% else %}
    {% set tables_list = [] %}
{% endif %}

{% if tables_list | length == 0 %}
    -- If no tables are found, return an empty result set
    select null as table_name, null as TableName, null as SeriesCode, null as LineNumber, null as LineDescription, null as TimePeriod, null as METRIC_NAME, null as CL_UNIT, null as UNIT_MULT, null as DataValue, null as NoteRef
    where false
{% else %}
    {% for table_name in tables_list %}
        select
          '{{ table_name }}' as table_name,
          tablename,
            seriescode,
            linenumber,
            linedescription,
            timeperiod,
            metric_name,
            cl_unit,
            unit_mult,
            datavalue,
            noteref
        from {{ source('bea', table_name) }}

        {% if not loop.last %}
        union all
        {% endif %}
    {% endfor %}
{% endif %}

================
File: dbt/econdash/models/bea_datasets_metadata.sql
================
with parsed_data as (
            select
                'nipa' as dataset_name,
                't10101' as table_name,
                'table 1.1.1. percent change from preceding period in real gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10102' as table_name,
                'table 1.1.2. contributions to percent change in real gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10103' as table_name,
                'table 1.1.3. real gross domestic product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10104' as table_name,
                'table 1.1.4. price indexes for gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10105' as table_name,
                'table 1.1.5. gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10106' as table_name,
                'table 1.1.6. real gross domestic product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10107' as table_name,
                'table 1.1.7. percent change from preceding period in prices for gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10108' as table_name,
                'table 1.1.8. contributions to percent change in the gross domestic product price index (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10109' as table_name,
                'table 1.1.9. implicit price deflators for gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10110' as table_name,
                'table 1.1.10. percentage shares of gross domestic product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10111' as table_name,
                'table 1.1.11. real gross domestic product: percent change from quarter one year ago (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10201' as table_name,
                'table 1.2.1. percent change from preceding period in real gross domestic product by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10202' as table_name,
                'table 1.2.2. contributions to percent change in real gross domestic product by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10203' as table_name,
                'table 1.2.3. real gross domestic product by major type of product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10204' as table_name,
                'table 1.2.4. price indexes for gross domestic product by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10205' as table_name,
                'table 1.2.5. gross domestic product by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10206' as table_name,
                'table 1.2.6. real gross domestic product by major type of product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10301' as table_name,
                'table 1.3.1. percent change from preceding period in real gross value added by sector (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10303' as table_name,
                'table 1.3.3. real gross value added by sector, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10304' as table_name,
                'table 1.3.4. price indexes for gross value added by sector (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10305' as table_name,
                'table 1.3.5. gross value added by sector (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10306' as table_name,
                'table 1.3.6. real gross value added by sector, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10401' as table_name,
                'table 1.4.1. percent change from preceding period in real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10403' as table_name,
                'table 1.4.3. real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10404' as table_name,
                'table 1.4.4. price indexes for gross domestic product, gross domestic purchases, and final sales to domestic purchasers (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10405' as table_name,
                'table 1.4.5. relation of gross domestic product, gross domestic purchases, and final sales to domestic purchasers (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10406' as table_name,
                'table 1.4.6. relation of real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10501' as table_name,
                'table 1.5.1. percent change from preceding period in real gross domestic product, expanded detail (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10502' as table_name,
                'table 1.5.2. contributions to percent change in real gross domestic product, expanded detail (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10503' as table_name,
                'table 1.5.3. real gross domestic product, expanded detail, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10504' as table_name,
                'table 1.5.4. price indexes for gross domestic product, expanded detail (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10505' as table_name,
                'table 1.5.5. gross domestic product, expanded detail (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10506' as table_name,
                'table 1.5.6. real gross domestic product, expanded detail, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10604' as table_name,
                'table 1.6.4. price indexes for gross domestic purchases (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10607' as table_name,
                'table 1.6.7. percent change from preceding period in prices for gross domestic purchases (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10608' as table_name,
                'table 1.6.8. contributions to percent change in the gross domestic purchases price index (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10701' as table_name,
                'table 1.7.1. percent change from preceding period in real gross domestic product, real gross national product, and real net national product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10703' as table_name,
                'table 1.7.3. real gross domestic product, real gross national product, and real net national product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10704' as table_name,
                'table 1.7.4. price indexes for gross domestic product, gross national product, and net national product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10705' as table_name,
                'table 1.7.5. relation of gross domestic product, gross national product, net national product, national income, and personal income (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10706' as table_name,
                'table 1.7.6. relation of real gross domestic product, real gross national product, and real net national product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10803' as table_name,
                'table 1.8.3. command-basis real gross domestic product and gross national product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10806' as table_name,
                'table 1.8.6. command-basis real gross domestic product and gross national product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10903' as table_name,
                'table 1.9.3. real net value added by sector, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10904' as table_name,
                'table 1.9.4. price indexes for net value added by sector (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10905' as table_name,
                'table 1.9.5. net value added by sector (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't10906' as table_name,
                'table 1.9.6. real net value added by sector, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11000' as table_name,
                'table 1.10. gross domestic income by type of income (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11100' as table_name,
                'table 1.11. percentage shares of gross domestic income (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11200' as table_name,
                'table 1.12. national income by type of income (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11300' as table_name,
                'table 1.13. national income by sector, legal form of organization, and type of income (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11400' as table_name,
                'table 1.14. gross value added of domestic corporate business in current dollars and gross value added of nonfinancial domestic corporate business in current and chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11500' as table_name,
                'table 1.15. price, costs, and profit per unit of real gross value added of nonfinancial domestic corporate business (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11600' as table_name,
                'table 1.16. sources and uses of private enterprise income (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11701' as table_name,
                'table 1.17.1. percent change from preceding period in real gross domestic product, real gross domestic income, and other major nipa aggregates (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11705' as table_name,
                'table 1.17.5. gross domestic product, gross domestic income, and other major nipa aggregates (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't11706' as table_name,
                'table 1.17.6. real gross domestic product, real gross domestic income, and other major nipa aggregates, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20100' as table_name,
                'table 2.1. personal income and its disposition (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20200a' as table_name,
                'table 2.2a. wages and salaries by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20200b' as table_name,
                'table 2.2b. wages and salaries by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20301' as table_name,
                'table 2.3.1. percent change from preceding period in real personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20302' as table_name,
                'table 2.3.2. contributions to percent change in real personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20303' as table_name,
                'table 2.3.3. real personal consumption expenditures by major type of product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20304' as table_name,
                'table 2.3.4. price indexes for personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20305' as table_name,
                'table 2.3.5. personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20306' as table_name,
                'table 2.3.6. real personal consumption expenditures by major type of product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20307' as table_name,
                'table 2.3.7. percent change from preceding period in prices for personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20308' as table_name,
                'table 2.3.8. contributions to percent change in prices for personal consumption expenditures by major type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20311' as table_name,
                'table 2.3.11. real personal consumption expenditures by major type of product: percent change from quarter one year ago (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20401' as table_name,
                'table 2.4.1. percent change from preceding period in real personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20402' as table_name,
                'table 2.4.2. contributions to percent change in real personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20403' as table_name,
                'table 2.4.3. real personal consumption expenditures by type of product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20404' as table_name,
                'table 2.4.4. price indexes for personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20405' as table_name,
                'table 2.4.5. personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20406' as table_name,
                'table 2.4.6. real personal consumption expenditures by type of product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20407' as table_name,
                'table 2.4.7. percent change from preceding period in prices for personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20408' as table_name,
                'table 2.4.8. contributions to percent change in prices for personal consumption expenditures by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20503' as table_name,
                'table 2.5.3. real personal consumption expenditures by function, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20504' as table_name,
                'table 2.5.4. price indexes for personal consumption expenditures by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20505' as table_name,
                'table 2.5.5. personal consumption expenditures by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20506' as table_name,
                'table 2.5.6. real personal consumption expenditures by function, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20600' as table_name,
                'table 2.6. personal income and its disposition, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20700a' as table_name,
                'table 2.7a. wages and salaries by industry, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20700b' as table_name,
                'table 2.7b. wages and salaries by industry, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20801' as table_name,
                'table 2.8.1. percent change from preceding period in real personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20802' as table_name,
                'table 2.8.2. contributions to percent change in real personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20803' as table_name,
                'table 2.8.3. real personal consumption expenditures by major type of product, monthly, quantity indexes (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20804' as table_name,
                'table 2.8.4. price indexes for personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20805' as table_name,
                'table 2.8.5. personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20806' as table_name,
                'table 2.8.6. real personal consumption expenditures by major type of product, monthly, chained dollars (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20807' as table_name,
                'table 2.8.7. percent change from preceding period in prices for personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20808' as table_name,
                'table 2.8.8. contributions to percent change in prices for personal consumption expenditures by major type of product, monthly (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20811' as table_name,
                'table 2.8.11. real personal consumption expenditures by major type of product: percent change from month one year ago (m)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't20900' as table_name,
                'table 2.9. personal income and its disposition by households and by nonprofit institutions serving households (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't21000' as table_name,
                'table 2.10. distributions of personal and disposable income for households (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30100' as table_name,
                'table 3.1. government current receipts and expenditures (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30200' as table_name,
                'table 3.2. federal government current receipts and expenditures (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30300' as table_name,
                'table 3.3. state and local government current receipts and expenditures (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30400' as table_name,
                'table 3.4. personal current tax receipts (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30500' as table_name,
                'table 3.5. taxes on production and imports (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30600' as table_name,
                'table 3.6. contributions for government social insurance (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30700' as table_name,
                'table 3.7. government current transfer receipts (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30800' as table_name,
                'table 3.8. current surplus of government enterprises (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30901' as table_name,
                'table 3.9.1. percent change from preceding period in real government consumption expenditures and gross investment (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30902' as table_name,
                'table 3.9.2. contributions to percent change in real government consumption expenditures and gross investment (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30903' as table_name,
                'table 3.9.3. real government consumption expenditures and gross investment, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30904' as table_name,
                'table 3.9.4. price indexes for government consumption expenditures and gross investment (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30905' as table_name,
                'table 3.9.5. government consumption expenditures and gross investment (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't30906' as table_name,
                'table 3.9.6. real government consumption expenditures and gross investment, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31001' as table_name,
                'table 3.10.1. percent change from preceding period in real government consumption expenditures and general government gross output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31003' as table_name,
                'table 3.10.3. real government consumption expenditures and general government gross output, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31004' as table_name,
                'table 3.10.4. price indexes for government consumption expenditures and general government gross output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31005' as table_name,
                'table 3.10.5. government consumption expenditures and general government gross output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31006' as table_name,
                'table 3.10.6. real government consumption expenditures and general government gross output, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31101' as table_name,
                'table 3.11.1. percent change from preceding period in real national defense consumption expenditures and gross investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31102' as table_name,
                'table 3.11.2. contributions to percent change in national defense consumption expenditures and gross investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31103' as table_name,
                'table 3.11.3. real national defense consumption expenditures and gross investment by type, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31104' as table_name,
                'table 3.11.4. price indexes for national defense consumption expenditures and gross investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31105' as table_name,
                'table 3.11.5. national defense consumption expenditures and gross investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31106' as table_name,
                'table 3.11.6. real national defense consumption expenditures and gross investment by type, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31200' as table_name,
                'table 3.12. government social benefits (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31300' as table_name,
                'table 3.13. subsidies (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31400' as table_name,
                'table 3.14. government social insurance funds current receipts and expenditures (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31501' as table_name,
                'table 3.15.1. percent change from preceding period in real government consumption expenditures and gross investment by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31502' as table_name,
                'table 3.15.2. contributions to percent change in real government consumption expenditures and gross investment by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31503' as table_name,
                'table 3.15.3. real government consumption expenditures and gross investment by function, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31504' as table_name,
                'table 3.15.4. price indexes for government consumption expenditures and gross investment by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31505' as table_name,
                'table 3.15.5. government consumption expenditures and gross investment by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31506' as table_name,
                'table 3.15.6. real government consumption expenditures and gross investment by function, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31600' as table_name,
                'table 3.16. government current expenditures by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31700' as table_name,
                'table 3.17. selected government current and capital expenditures by function (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31800a' as table_name,
                'table 3.18a. relation of federal government current receipts and expenditures in the national income and product accounts to the consolidated cash statement, fiscal years and quarters (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31800b' as table_name,
                'table 3.18b. relation of federal government current receipts and expenditures in the national income and product accounts to the budget, fiscal years and quarters (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't31900' as table_name,
                'table 3.19. relation of state and local government current receipts and expenditures in the national income and product accounts to census bureau ''government finances'' data, fiscal years (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't32000' as table_name,
                'table 3.20. state government current receipts and expenditures (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't32100' as table_name,
                'table 3.21. local government current receipts and expenditures (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40100' as table_name,
                'table 4.1. foreign transactions in the national income and product accounts (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40201' as table_name,
                'table 4.2.1. percent change from preceding period in real exports and in real imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40202' as table_name,
                'table 4.2.2. contributions to percent change in real exports and real imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40203a' as table_name,
                'table 4.2.3a. real exports and imports of goods and services by type of product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40203b' as table_name,
                'table 4.2.3b. real exports and imports of goods and services by type of product, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40204a' as table_name,
                'table 4.2.4a. price indexes for exports and imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40204b' as table_name,
                'table 4.2.4b. price indexes for exports and imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40205a' as table_name,
                'table 4.2.5a. exports and imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40205b' as table_name,
                'table 4.2.5b. exports and imports of goods and services by type of product (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't40206b' as table_name,
                'table 4.2.6b. real exports and imports of goods and services by type of product, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't4030a' as table_name,
                'table 4.3a. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't4030b' as table_name,
                'table 4.3b. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't4030c' as table_name,
                'table 4.3c. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50100' as table_name,
                'table 5.1. saving and investment by sector (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50203' as table_name,
                'table 5.2.3. real gross and net domestic investment by major type, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50205' as table_name,
                'table 5.2.5. gross and net domestic investment by major type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50206' as table_name,
                'table 5.2.6. real gross and net domestic investment by major type, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50301' as table_name,
                'table 5.3.1. percent change from preceding period in real private fixed investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50302' as table_name,
                'table 5.3.2. contributions to percent change in real private fixed investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50303' as table_name,
                'table 5.3.3. real private fixed investment by type, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50304' as table_name,
                'table 5.3.4. price indexes for private fixed investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50305' as table_name,
                'table 5.3.5. private fixed investment by type (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50306' as table_name,
                'table 5.3.6. real private fixed investment by type, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50401' as table_name,
                'table 5.4.1. percent change from preceding period in real private fixed investment in structures by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50402' as table_name,
                'table 5.4.2. contributions to percent change in real private fixed investment in structures by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50403' as table_name,
                'table 5.4.3. real private fixed investment in structures by type, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50404' as table_name,
                'table 5.4.4. price indexes for private fixed investment in structures by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50405' as table_name,
                'table 5.4.5. private fixed investment in structures by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50406' as table_name,
                'table 5.4.6. real private fixed investment in structures by type, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50501' as table_name,
                'table 5.5.1. percent change from preceding period in real private fixed investment in equipment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50502' as table_name,
                'table 5.5.2. contributions to percent change in real private fixed investment in equipment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50503' as table_name,
                'table 5.5.3. real private fixed investment in equipment by type, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50504' as table_name,
                'table 5.5.4. price indexes for private fixed investment in equipment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50505' as table_name,
                'table 5.5.5. private fixed investment in equipment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50506' as table_name,
                'table 5.5.6. real private fixed investment in equipment by type, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50601' as table_name,
                'table 5.6.1. percent change from preceding period in real private fixed investment in intellectual property products by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50602' as table_name,
                'table 5.6.2. contributions to percent change in private fixed investment in intellectual property products by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50603' as table_name,
                'table 5.6.3. real private fixed investment in intellectual property products by type, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50604' as table_name,
                'table 5.6.4. price indexes for private fixed investment in intellectual property products by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50605' as table_name,
                'table 5.6.5. private fixed investment in intellectual property products by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50606' as table_name,
                'table 5.6.6. real private fixed investment in intellectual property products by type, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50705a' as table_name,
                'table 5.7.5a. change in private inventories by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50705b' as table_name,
                'table 5.7.5b. change in private inventories by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50706a' as table_name,
                'table 5.7.6a. change in real private inventories by industry, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50706b' as table_name,
                'table 5.7.6b. change in real private inventories by industry, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50805a' as table_name,
                'table 5.8.5a. private inventories and domestic final sales of business by industry (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50805b' as table_name,
                'table 5.8.5b. private inventories and domestic final sales by industry (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50806a' as table_name,
                'table 5.8.6a. real private inventories and real domestic final sales of business by industry, chained dollars (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50806b' as table_name,
                'table 5.8.6b. real private inventories and real domestic final sales by industry, chained dollars (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50809a' as table_name,
                'table 5.8.9a. implicit price deflators for private inventories by industry (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50809b' as table_name,
                'table 5.8.9b. implicit price deflators for private inventories by industry (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50903' as table_name,
                'table 5.9.3. real gross government fixed investment by type, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50904' as table_name,
                'table 5.9.4. price indexes for gross government fixed investment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50905' as table_name,
                'table 5.9.5. gross government fixed investment by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't50906' as table_name,
                'table 5.9.6. real gross government fixed investment by type, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't51000' as table_name,
                'table 5.10. changes in net stock of produced assets (fixed assets and inventories) (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't51100' as table_name,
                'table 5.11. capital transfers paid and received, by sector and by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60100b' as table_name,
                'table 6.1b. national income without capital consumption adjustment by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60100c' as table_name,
                'table 6.1c. national income without capital consumption adjustment by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60100d' as table_name,
                'table 6.1d. national income without capital consumption adjustment by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60200a' as table_name,
                'table 6.2a. compensation of employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60200b' as table_name,
                'table 6.2b. compensation of employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60200c' as table_name,
                'table 6.2c. compensation of employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60200d' as table_name,
                'table 6.2d. compensation of employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60300a' as table_name,
                'table 6.3a. wages and salaries by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60300b' as table_name,
                'table 6.3b. wages and salaries by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60300c' as table_name,
                'table 6.3c. wages and salaries by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60300d' as table_name,
                'table 6.3d. wages and salaries by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60400a' as table_name,
                'table 6.4a. full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60400b' as table_name,
                'table 6.4b. full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60400c' as table_name,
                'table 6.4c. full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60400d' as table_name,
                'table 6.4d. full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60500a' as table_name,
                'table 6.5a. full-time equivalent employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60500b' as table_name,
                'table 6.5b. full-time equivalent employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60500c' as table_name,
                'table 6.5c. full-time equivalent employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60500d' as table_name,
                'table 6.5d. full-time equivalent employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60600a' as table_name,
                'table 6.6a. wages and salaries per full-time equivalent employee by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60600b' as table_name,
                'table 6.6b. wages and salaries per full-time equivalent employee by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60600c' as table_name,
                'table 6.6c. wages and salaries per full-time equivalent employee by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60600d' as table_name,
                'table 6.6d. wages and salaries per full-time equivalent employee by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60700a' as table_name,
                'table 6.7a. self-employed persons by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60700b' as table_name,
                'table 6.7b. self-employed persons by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60700c' as table_name,
                'table 6.7c. self-employed persons by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60700d' as table_name,
                'table 6.7d. self-employed persons by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60800a' as table_name,
                'table 6.8a. persons engaged in production by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60800b' as table_name,
                'table 6.8b. persons engaged in production by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60800c' as table_name,
                'table 6.8c. persons engaged in production by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60800d' as table_name,
                'table 6.8d. persons engaged in production by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60900b' as table_name,
                'table 6.9b. hours worked by full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60900c' as table_name,
                'table 6.9c. hours worked by full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't60900d' as table_name,
                'table 6.9d. hours worked by full-time and part-time employees by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61000b' as table_name,
                'table 6.10b. employer contributions for government social insurance by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61000c' as table_name,
                'table 6.10c. employer contributions for government social insurance by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61000d' as table_name,
                'table 6.10d. employer contributions for government social insurance by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61100a' as table_name,
                'table 6.11a. employer contributions for employee pension and insurance funds by industry and by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61100b' as table_name,
                'table 6.11b. employer contributions for employee pension and insurance funds by industry and by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61100c' as table_name,
                'table 6.11c. employer contributions for employee pension and insurance funds by industry and by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61100d' as table_name,
                'table 6.11d. employer contributions for employee pension and insurance funds by industry and by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61200a' as table_name,
                'table 6.12a. nonfarm proprietors'' income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61200b' as table_name,
                'table 6.12b. nonfarm proprietors'' income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61200c' as table_name,
                'table 6.12c. nonfarm proprietors'' income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61200d' as table_name,
                'table 6.12d. nonfarm proprietors'' income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61300a' as table_name,
                'table 6.13a. noncorporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61300b' as table_name,
                'table 6.13b. noncorporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61300c' as table_name,
                'table 6.13c. noncorporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61300d' as table_name,
                'table 6.13d. noncorporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61400a' as table_name,
                'table 6.14a. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61400b' as table_name,
                'table 6.14b. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61400c' as table_name,
                'table 6.14c. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61400d' as table_name,
                'table 6.14d. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61500a' as table_name,
                'table 6.15a. net interest by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61500b' as table_name,
                'table 6.15b. net interest by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61500c' as table_name,
                'table 6.15c. net interest by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61500d' as table_name,
                'table 6.15d. net interest by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61600a' as table_name,
                'table 6.16a. corporate profits by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61600b' as table_name,
                'table 6.16b. corporate profits by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61600c' as table_name,
                'table 6.16c. corporate profits by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61600d' as table_name,
                'table 6.16d. corporate profits by industry (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61700a' as table_name,
                'table 6.17a. corporate profits before tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61700b' as table_name,
                'table 6.17b. corporate profits before tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61700c' as table_name,
                'table 6.17c. corporate profits before tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61700d' as table_name,
                'table 6.17d. corporate profits before tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61800a' as table_name,
                'table 6.18a. taxes on corporate income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61800b' as table_name,
                'table 6.18b. taxes on corporate income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61800c' as table_name,
                'table 6.18c. taxes on corporate income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61800d' as table_name,
                'table 6.18d. taxes on corporate income by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61900a' as table_name,
                'table 6.19a. corporate profits after tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61900b' as table_name,
                'table 6.19b. corporate profits after tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61900c' as table_name,
                'table 6.19c. corporate profits after tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't61900d' as table_name,
                'table 6.19d. corporate profits after tax by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62000a' as table_name,
                'table 6.20a. net corporate dividend payments by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62000b' as table_name,
                'table 6.20b. net corporate dividend payments by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62000c' as table_name,
                'table 6.20c. net corporate dividend payments by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62000d' as table_name,
                'table 6.20d. net corporate dividend payments by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62100a' as table_name,
                'table 6.21a. undistributed corporate profits by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62100b' as table_name,
                'table 6.21b. undistributed corporate profits by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62100c' as table_name,
                'table 6.21c. undistributed corporate profits by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62100d' as table_name,
                'table 6.21d. undistributed corporate profits by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62200a' as table_name,
                'table 6.22a. corporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62200b' as table_name,
                'table 6.22b. corporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62200c' as table_name,
                'table 6.22c. corporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't62200d' as table_name,
                'table 6.22d. corporate capital consumption allowances by industry (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70100' as table_name,
                'table 7.1. selected per capita product and income series in current and chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70201a' as table_name,
                'table 7.2.1a. percent change from preceding period in real auto output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70201b' as table_name,
                'table 7.2.1b. percent change from preceding period in real motor vehicle output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70203a' as table_name,
                'table 7.2.3a. real auto output, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70203b' as table_name,
                'table 7.2.3b. real motor vehicle output, quantity indexes (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70204a' as table_name,
                'table 7.2.4a. price indexes for auto output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70204b' as table_name,
                'table 7.2.4b. price indexes for motor vehicle output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70205a' as table_name,
                'table 7.2.5a. auto output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70205b' as table_name,
                'table 7.2.5b. motor vehicle output (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70206b' as table_name,
                'table 7.2.6b. real motor vehicle output, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70303' as table_name,
                'table 7.3.3. real farm sector output, real gross value added, and real net value added, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70304' as table_name,
                'table 7.3.4. price indexes for farm sector output, gross value added, and net value added (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70305' as table_name,
                'table 7.3.5. farm sector output, gross value added, and net value added (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70306' as table_name,
                'table 7.3.6. real farm sector output, real gross value added, and real net value added, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70403' as table_name,
                'table 7.4.3. real housing sector output, real gross value added, and real net value added, quantity indexes (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70404' as table_name,
                'table 7.4.4. price indexes for housing sector output, gross value added, and net value added (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70405' as table_name,
                'table 7.4.5. housing sector output, gross value added, and net value added (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70406' as table_name,
                'table 7.4.6. real housing sector output, real gross value added, and real net value added, chained dollars (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70500' as table_name,
                'table 7.5. consumption of fixed capital by legal form of organization and type of income (a) (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70600' as table_name,
                'table 7.6. capital consumption adjustment by legal form of organization and type of adjustment (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70700' as table_name,
                'table 7.7. business current transfer payments by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70800' as table_name,
                'table 7.8. supplements to wages and salaries by type (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't70900' as table_name,
                'table 7.9. rental income of persons by legal form of organization and by type of income (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71000' as table_name,
                'table 7.10. dividends paid and received by sector (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71100' as table_name,
                'table 7.11. interest paid and received by sector and legal form of organization (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71200' as table_name,
                'table 7.12. imputations in the national income and product accounts (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71300' as table_name,
                'table 7.13. relation of consumption of fixed capital in the national income and product accounts to depreciation and amortization as published by the internal revenue service (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71400' as table_name,
                'table 7.14. relation of nonfarm proprietors'' income in the national income and product accounts to corresponding measures as published by the internal revenue service (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71500' as table_name,
                'table 7.15. relation of net farm income in the national income and product accounts to net farm income as published by the u.s. department of agriculture (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71600' as table_name,
                'table 7.16. relation of corporate profits, taxes, and dividends in the national income and product accounts to corresponding measures as published by the internal revenue service (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71700' as table_name,
                'table 7.17. relation of monetary interest paid and received in the national income and product accounts to corresponding measures as published by the internal revenue service (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71800' as table_name,
                'table 7.18. relation of wages and salaries in the national income and product accounts to wages and salaries as published by the bureau of labor statistics (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't71900' as table_name,
                'table 7.19. comparison of income and outlays of nonprofit institutions serving households with revenue and expenses as published by the internal revenue service (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72000' as table_name,
                'table 7.20. transactions of defined benefit and defined contribution pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72100' as table_name,
                'table 7.21. transactions of defined benefit pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72200' as table_name,
                'table 7.22. transactions of private defined benefit pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72300' as table_name,
                'table 7.23. transactions of federal government defined benefit pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72400' as table_name,
                'table 7.24. transactions of state and local government defined benefit pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't72500' as table_name,
                'table 7.25. transactions of defined contribution pension plans (a)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80103' as table_name,
                'table 8.1.3. real gross domestic product, quantity indexes, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80104' as table_name,
                'table 8.1.4. price indexes for gross domestic product, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80105' as table_name,
                'table 8.1.5. gross domestic product, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80106' as table_name,
                'table 8.1.6. real gross domestic product, chained dollars, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80111' as table_name,
                'table 8.1.11. real gross domestic product: percent change from quarter one year ago, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80200' as table_name,
                'table 8.2. gross domestic income by type of income, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80300' as table_name,
                'table 8.3. federal government current receipts and expenditures, not seasonally adjusted (q)' as table_description
             union all 
        
            select
                'nipa' as dataset_name,
                't80400' as table_name,
                'table 8.4. state and local government current receipts and expenditures, not seasonally adjusted (q)' as table_description
            
        
         union all 
    
        
            select
                'niunderlyingdetail' as dataset_name,
                'u001a' as table_name,
                'table 1au. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 1996 dollars, 1967-96, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u001a2' as table_name,
                'table 1au2. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 2017 dollars, 1967-96, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u001b' as table_name,
                'table 1bu. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u001bc' as table_name,
                'table 1buc. current dollar manufacturing and trade inventories, seasonally adjusted, end of period [1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u002au' as table_name,
                'table 2au. real manufacturing and trade sales, seasonally adjusted at monthly rate [chained 1996 dollars, 1967-96, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u002aui' as table_name,
                'table 2aui. implicit price deflators for manufacturing and trade sales [index base 1996, 1967-96, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u002bu' as table_name,
                'table 2bu. real manufacturing and trade sales, seasonally adjusted at monthly rate [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u002bui' as table_name,
                'table 2bui. implicit price deflators for manufacturing and trade sales [index base 2017, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u003au' as table_name,
                'table 3au. real inventory-sales ratios for manufacturing and trade, seasonally adjusted [based on chained 1996 dollars, 1967-96, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u003bu' as table_name,
                'table 3bu. real inventory-sales ratios for manufacturing and trade, seasonally adjusted [based on chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004a1' as table_name,
                'table 4au1. real manufacturing inventories, by stage of fabrication (materials and supplies), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004a2' as table_name,
                'table 4au2. real manufacturing inventories, by stage of fabrication (works-in-process), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004a3' as table_name,
                'table 4au3. real manufacturing inventories, by stage of fabrication (finished goods), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004b1' as table_name,
                'table 4bu1. real manufacturing inventories, by stage of fabrication (materials and supplies), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004b2' as table_name,
                'table 4bu2. real manufacturing inventories, by stage of fabrication (work-in-process), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u004b3' as table_name,
                'table 4bu3. real manufacturing inventories, by stage of fabrication (finished goods), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u00500' as table_name,
                'table 5u. bea retail and food service sales (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u00600' as table_name,
                'table 6u. real bea retail and food service sales (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u00700' as table_name,
                'table 7u. chain-type price indexes for bea retail and food service sales (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20304' as table_name,
                'table 2.3.4u. price indexes for personal consumption expenditures by major type of product and by major function (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20305' as table_name,
                'table 2.3.5u. personal consumption expenditures by major type of product and by major function (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20306' as table_name,
                'table 2.3.6u. real personal consumption expenditures by major type of product and by major function (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20403' as table_name,
                'table 2.4.3u. real personal consumption expenditures by type of product, quantity indexes (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20404' as table_name,
                'table 2.4.4u. price indexes for personal consumption expenditures by type of product (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20405' as table_name,
                'table 2.4.5u. personal consumption expenditures by type of product (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u20406' as table_name,
                'table 2.4.6u. real personal consumption expenditures by type of product, chained dollars (a) (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u30400' as table_name,
                'table 3.4u. personal current tax receipts (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u30500' as table_name,
                'table 3.5u. taxes on production and imports (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u30600' as table_name,
                'table 3.6u. contributions for government social insurance (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u30700' as table_name,
                'table 3.7u. government current transfer receipts (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u30800' as table_name,
                'table 3.8u. current surplus of government enterprises (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u31200' as table_name,
                'table 3.12u. government social benefits (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u31300' as table_name,
                'table 3.13u. subsidies (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u32400' as table_name,
                'table 3.24u. federal grants-in-aid to state and local governments (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u32500' as table_name,
                'table 3.25u. compensation of general government employees (a)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u4030b' as table_name,
                'table 4.3bu. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50203' as table_name,
                'table 5.2.3u. real gross and net domestic investment by major type, quantity indexes (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50205' as table_name,
                'table 5.2.5u. gross and net domestic investment by major type (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50206' as table_name,
                'table 5.2.6u. real gross and net domestic investment by major type, chained dollars (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50404' as table_name,
                'table 5.4.4u. price indexes for private fixed investment in structures by type (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50405' as table_name,
                'table 5.4.5u. private fixed investment in structures by type (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50406' as table_name,
                'table 5.4.6u. private fixed investment in structures by type, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50504' as table_name,
                'table 5.5.4u. price indexes for private fixed investment in equipment  by type (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50505' as table_name,
                'table 5.5.5u. private fixed investment in equipment  by type (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50506' as table_name,
                'table 5.5.6u. private fixed investment in equipment  by type, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705am1' as table_name,
                'table 5.7.5am1. change in private inventories by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705am2' as table_name,
                'table 5.7.5am2. change in book value by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705am3' as table_name,
                'table 5.7.5am3. inventory valuation adjustment by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705au1' as table_name,
                'table 5.7.5au1. change in private inventories by industry (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705au2' as table_name,
                'table 5.7.5au2. change in book value by industry (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705au3' as table_name,
                'table 5.7.5au3. inventory valuation adjustment by industry (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bm1' as table_name,
                'table 5.7.5bm1. change in private inventories by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bm2' as table_name,
                'table 5.7.5bm2. change in book value by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bm3' as table_name,
                'table 5.7.5bm3. inventory valuation adjustment by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bu1' as table_name,
                'table 5.7.5bu1. change in private inventories by industry (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bu2' as table_name,
                'table 5.7.5bu2. change in book value by industry (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50705bu3' as table_name,
                'table 5.7.5bu3. inventory valuation adjustment by industry (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50706am' as table_name,
                'table 5.7.6am. change in real private inventories by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50706au' as table_name,
                'table 5.7.6au. change in real private inventories by industry (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50706bm' as table_name,
                'table 5.7.6bm. change in real private inventories by industry (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u50706bu' as table_name,
                'table 5.7.6bu. change in real private inventories by industry (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u51100' as table_name,
                'table 5.11u. capital transfers paid and received, by sector and by type (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u70204' as table_name,
                'table 7.2.4u. price indexes for motor vehicle output (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u70205' as table_name,
                'table 7.2.5u. motor vehicle output (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u70205s' as table_name,
                'table 7.2.5s. auto and truck unit sales, production, inventories, expenditures, and price (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u70206' as table_name,
                'table 7.2.6u. real motor vehicle output, chained dollars (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u90100' as table_name,
                'table 9.1u. reconciliation of percent change in the cpi with percent change in the pce price index (q) (m)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u90200' as table_name,
                'table 9.2u. final sales of domestic computers (a) (q)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u90300' as table_name,
                'table 9.3u. gross domestic product and final sales of software (a)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u90400' as table_name,
                'table 9.4u. software investment and prices (a)' as table_description
             union all 
        
            select
                'niunderlyingdetail' as dataset_name,
                'u90500' as table_name,
                'table 9.5u. contributions to percent change in real gross domestic product from final sales of computers, software, and communications equipment (a)' as table_description
            
        
         union all 
    
        
            select
                'fixedassets' as dataset_name,
                'faat101' as table_name,
                'table 1.1. current-cost net stock of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat102' as table_name,
                'table 1.2. chain-type quantity indexes for net stock of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat103' as table_name,
                'table 1.3. current-cost depreciation of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat104' as table_name,
                'table 1.4. chain-type quantity indexes for depreciation of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat105' as table_name,
                'table 1.5. investment in fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat106' as table_name,
                'table 1.6. chain-type quantity indexes for investment in fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat107' as table_name,
                'table 1.7. current-cost other changes in volume of assets for fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat108' as table_name,
                'table 1.8. historical-cost other changes in volume of assets for fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat109' as table_name,
                'table 1.9. current-cost average age at yearend of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat201' as table_name,
                'table 2.1. current-cost net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat202' as table_name,
                'table 2.2. chain-type quantity indexes for net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat203' as table_name,
                'table 2.3. historical-cost net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat204' as table_name,
                'table 2.4. current-cost depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat205' as table_name,
                'table 2.5. chain-type quantity indexes for depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat206' as table_name,
                'table 2.6. historical-cost depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat207' as table_name,
                'table 2.7. investment in private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat208' as table_name,
                'table 2.8. chain-type quantity indexes for investment in private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat209' as table_name,
                'table 2.9. current-cost average age at yearend of private fixed assets, equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat210' as table_name,
                'table 2.10. historical-cost average age at yearend of private fixed assets,  equipment, structures, and intellectual property products by type (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat301e' as table_name,
                'table 3.1e. current-cost net stock of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat301esi' as table_name,
                'table 3.1esi. current-cost net stock of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat301i' as table_name,
                'table 3.1i. current-cost net stock of intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat301s' as table_name,
                'table 3.1s. current-cost net stock of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat302e' as table_name,
                'table 3.2e. chain-type quantity indexes for net stock of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat302esi' as table_name,
                'table 3.2esi. chain-type quantity indexes for net stock of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat302i' as table_name,
                'table 3.2i. chain-type quantity indexes for net stock of intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat302s' as table_name,
                'table 3.2s. chain-type quantity indexes for net stock of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat303e' as table_name,
                'table 3.3e. historical-cost net stock of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat303esi' as table_name,
                'table 3.3esi. historical-cost net stock of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat303i' as table_name,
                'table 3.3i. historical-cost net stock of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat303s' as table_name,
                'table 3.3s. historical-cost net stock of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat304e' as table_name,
                'table 3.4e. current-cost depreciation of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat304esi' as table_name,
                'table 3.4esi. current-cost depreciation of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat304i' as table_name,
                'table 3.4i. current-cost depreciation of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat304s' as table_name,
                'table 3.4s. current-cost depreciation of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat305e' as table_name,
                'table 3.5e. chain-type quantity indexes for depreciation of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat305esi' as table_name,
                'table 3.5esi. chain-type quantity indexes for depreciation of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat305i' as table_name,
                'table 3.5i. chain-type quantity indexes for depreciation of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat305s' as table_name,
                'table 3.5s. chain-type quantity indexes for depreciation of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat306e' as table_name,
                'table 3.6e. historical-cost depreciation of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat306esi' as table_name,
                'table 3.6esi. historical-cost depreciation of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat306i' as table_name,
                'table 3.6i. historical-cost depreciation of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat306s' as table_name,
                'table 3.6s. historical-cost depreciation of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat307e' as table_name,
                'table 3.7e. investment in private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat307esi' as table_name,
                'table 3.7esi. investment in private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat307i' as table_name,
                'table 3.7i. investment in private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat307s' as table_name,
                'table 3.7s. investment in private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat308e' as table_name,
                'table 3.8e. chain-type quantity indexes for investment in private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat308esi' as table_name,
                'table 3.8esi. chain-type quantity indexes for investment in private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat308i' as table_name,
                'table 3.8i. chain-type quantity indexes for investment in private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat308s' as table_name,
                'table 3.8s. chain-type quantity indexes for investment in private structures by  industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat309e' as table_name,
                'table 3.9e. current-cost average age at yearend of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat309esi' as table_name,
                'table 3.9esi. current-cost average age at yearend of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat309i' as table_name,
                'table 3.9i. current-cost average age at yearend of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat309s' as table_name,
                'table 3.9s. current-cost average age at yearend of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat310e' as table_name,
                'table 3.10e. historical-cost average age at yearend of private equipment by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat310esi' as table_name,
                'table 3.10esi. historical-cost average age at yearend of private fixed assets by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat310i' as table_name,
                'table 3.10i. historical-cost average age at yearend of private intellectual property products by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat310s' as table_name,
                'table 3.10s. historical-cost average age at yearend of private structures by industry (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat401' as table_name,
                'table 4.1. current-cost net stock of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat402' as table_name,
                'table 4.2. chain-type quantity indexes for net stock of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat403' as table_name,
                'table 4.3. historical-cost net stock of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat404' as table_name,
                'table 4.4. current-cost depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat405' as table_name,
                'table 4.5. chain-type quantity indexes for depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat406' as table_name,
                'table 4.6. historical-cost depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat407' as table_name,
                'table 4.7. investment in private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat408' as table_name,
                'table 4.8. chain-type quantity indexes for investment in private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat409' as table_name,
                'table 4.9. current-cost average age at yearend of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat410' as table_name,
                'table 4.10. historical-cost average age at yearend of private nonresidential fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat501' as table_name,
                'table 5.1. current-cost net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat502' as table_name,
                'table 5.2. chain-type quantity indexes for net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat503' as table_name,
                'table 5.3. historical-cost net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat504' as table_name,
                'table 5.4. current-cost depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat505' as table_name,
                'table 5.5. chain-type quantity indexes for depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat506' as table_name,
                'table 5.6. historical-cost depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat507' as table_name,
                'table 5.7. investment in residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat508' as table_name,
                'table 5.8. chain-type quantity indexes for investment in residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat509' as table_name,
                'table 5.9. current-cost average age at yearend of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat510' as table_name,
                'table 5.10. historical-cost average age at yearend of residential fixed assets by type of owner, legal form of organization, and tenure group (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat601' as table_name,
                'table 6.1. current-cost net stock of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat602' as table_name,
                'table 6.2. chain-type quantity indexes for net stock of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat603' as table_name,
                'table 6.3. historical-cost net stock of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat604' as table_name,
                'table 6.4. current-cost depreciation of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat605' as table_name,
                'table 6.5. chain-type quantity indexes for depreciation of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat606' as table_name,
                'table 6.6. historical-cost depreciation of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat607' as table_name,
                'table 6.7. investment in private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat608' as table_name,
                'table 6.8. chain-type quantity indexes for investment in private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat609' as table_name,
                'table 6.9. current-cost average age at yearend of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat610' as table_name,
                'table 6.10. historical-cost average age at yearend of private fixed assets by industry group and legal form of organization (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat701' as table_name,
                'table 7.1. current-cost net stock of government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat702' as table_name,
                'table 7.2. chain-type quantity indexes for net stock of government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat703' as table_name,
                'table 7.3. current-cost depreciation of government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat704' as table_name,
                'table 7.4. chain-type quantity indexes for depreciation of government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat705' as table_name,
                'table 7.5. investment in government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat706' as table_name,
                'table 7.6. chain-type quantity indexes for investment in government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat707' as table_name,
                'table 7.7. current-cost average age at yearend of government fixed assets (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat801' as table_name,
                'table 8.1. current-cost net stock of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat802' as table_name,
                'table 8.2. chain-type quantity indexes for net stock of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat803' as table_name,
                'table 8.3. historical-cost net stock of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat804' as table_name,
                'table 8.4. current-cost depreciation of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat805' as table_name,
                'table 8.5. chain-type quantity indexes for depreciation of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat806' as table_name,
                'table 8.6. historical-cost depreciation of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat807' as table_name,
                'table 8.7. investment in consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat808' as table_name,
                'table 8.8. chain-type quantity indexes for investment in consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat809' as table_name,
                'table 8.9. current-cost average age at yearend of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat810' as table_name,
                'table 8.10. historical-cost average age at yearend of consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat901' as table_name,
                'table 9.1. real net stock of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat902' as table_name,
                'table 9.2. real depreciation of fixed assets and consumer durable goods (a)' as table_description
             union all 
        
            select
                'fixedassets' as dataset_name,
                'faat903' as table_name,
                'table 9.3. real investment in fixed assets and consumer durable goods (a)' as table_description
)
select * from parsed_data

================
File: dbt/econdash/models/sources.yml
================
version: 2

sources:
  - name: bea
    tables:
          - name: nipa_t10101
            description: "table 1.1.1. percent change from preceding period in real gross domestic product (a) (q)"
          - name: nipa_t10102
            description: "table 1.1.2. contributions to percent change in real gross domestic product (a) (q)"
          - name: nipa_t10103
            description: "table 1.1.3. real gross domestic product, quantity indexes (a) (q)"
          - name: nipa_t10104
            description: "table 1.1.4. price indexes for gross domestic product (a) (q)"
          - name: nipa_t10105
            description: "table 1.1.5. gross domestic product (a) (q)"
          - name: nipa_t10106
            description: "table 1.1.6. real gross domestic product, chained dollars (a) (q)"
          - name: nipa_t10107
            description: "table 1.1.7. percent change from preceding period in prices for gross domestic product (a) (q)"
          - name: nipa_t10108
            description: "table 1.1.8. contributions to percent change in the gross domestic product price index (a) (q)"
          - name: nipa_t10109
            description: "table 1.1.9. implicit price deflators for gross domestic product (a) (q)"
          - name: nipa_t10110
            description: "table 1.1.10. percentage shares of gross domestic product (a) (q)"
          - name: nipa_t10111
            description: "table 1.1.11. real gross domestic product: percent change from quarter one year ago (q)"
          - name: nipa_t10201
            description: "table 1.2.1. percent change from preceding period in real gross domestic product by major type of product (a) (q)"
          - name: nipa_t10202
            description: "table 1.2.2. contributions to percent change in real gross domestic product by major type of product (a) (q)"
          - name: nipa_t10203
            description: "table 1.2.3. real gross domestic product by major type of product, quantity indexes (a) (q)"
          - name: nipa_t10204
            description: "table 1.2.4. price indexes for gross domestic product by major type of product (a) (q)"
          - name: nipa_t10205
            description: "table 1.2.5. gross domestic product by major type of product (a) (q)"
          - name: nipa_t10206
            description: "table 1.2.6. real gross domestic product by major type of product, chained dollars (a) (q)"
          - name: nipa_t10301
            description: "table 1.3.1. percent change from preceding period in real gross value added by sector (a) (q)"
          - name: nipa_t10303
            description: "table 1.3.3. real gross value added by sector, quantity indexes (a) (q)"
          - name: nipa_t10304
            description: "table 1.3.4. price indexes for gross value added by sector (a) (q)"
          - name: nipa_t10305
            description: "table 1.3.5. gross value added by sector (a) (q)"
          - name: nipa_t10306
            description: "table 1.3.6. real gross value added by sector, chained dollars (a) (q)"
          - name: nipa_t10401
            description: "table 1.4.1. percent change from preceding period in real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers (a) (q)"
          - name: nipa_t10403
            description: "table 1.4.3. real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers, quantity indexes (a) (q)"
          - name: nipa_t10404
            description: "table 1.4.4. price indexes for gross domestic product, gross domestic purchases, and final sales to domestic purchasers (a) (q)"
          - name: nipa_t10405
            description: "table 1.4.5. relation of gross domestic product, gross domestic purchases, and final sales to domestic purchasers (a) (q)"
          - name: nipa_t10406
            description: "table 1.4.6. relation of real gross domestic product, real gross domestic purchases, and real final sales to domestic purchasers, chained dollars (a) (q)"
          - name: nipa_t10501
            description: "table 1.5.1. percent change from preceding period in real gross domestic product, expanded detail (a) (q)"
          - name: nipa_t10502
            description: "table 1.5.2. contributions to percent change in real gross domestic product, expanded detail (a) (q)"
          - name: nipa_t10503
            description: "table 1.5.3. real gross domestic product, expanded detail, quantity indexes (a) (q)"
          - name: nipa_t10504
            description: "table 1.5.4. price indexes for gross domestic product, expanded detail (a) (q)"
          - name: nipa_t10505
            description: "table 1.5.5. gross domestic product, expanded detail (a) (q)"
          - name: nipa_t10506
            description: "table 1.5.6. real gross domestic product, expanded detail, chained dollars (a) (q)"
          - name: nipa_t10604
            description: "table 1.6.4. price indexes for gross domestic purchases (a) (q)"
          - name: nipa_t10607
            description: "table 1.6.7. percent change from preceding period in prices for gross domestic purchases (a) (q)"
          - name: nipa_t10608
            description: "table 1.6.8. contributions to percent change in the gross domestic purchases price index (a) (q)"
          - name: nipa_t10701
            description: "table 1.7.1. percent change from preceding period in real gross domestic product, real gross national product, and real net national product (a) (q)"
          - name: nipa_t10703
            description: "table 1.7.3. real gross domestic product, real gross national product, and real net national product, quantity indexes (a) (q)"
          - name: nipa_t10704
            description: "table 1.7.4. price indexes for gross domestic product, gross national product, and net national product (a) (q)"
          - name: nipa_t10705
            description: "table 1.7.5. relation of gross domestic product, gross national product, net national product, national income, and personal income (a) (q)"
          - name: nipa_t10706
            description: "table 1.7.6. relation of real gross domestic product, real gross national product, and real net national product, chained dollars (a) (q)"
          - name: nipa_t10803
            description: "table 1.8.3. command-basis real gross domestic product and gross national product, quantity indexes (a) (q)"
          - name: nipa_t10806
            description: "table 1.8.6. command-basis real gross domestic product and gross national product, chained dollars (a) (q)"
          - name: nipa_t10903
            description: "table 1.9.3. real net value added by sector, quantity indexes (a)"
          - name: nipa_t10904
            description: "table 1.9.4. price indexes for net value added by sector (a)"
          - name: nipa_t10905
            description: "table 1.9.5. net value added by sector (a)"
          - name: nipa_t10906
            description: "table 1.9.6. real net value added by sector, chained dollars (a)"
          - name: nipa_t11000
            description: "table 1.10. gross domestic income by type of income (a) (q)"
          - name: nipa_t11100
            description: "table 1.11. percentage shares of gross domestic income (a)"
          - name: nipa_t11200
            description: "table 1.12. national income by type of income (a) (q)"
          - name: nipa_t11300
            description: "table 1.13. national income by sector, legal form of organization, and type of income (a)"
          - name: nipa_t11400
            description: "table 1.14. gross value added of domestic corporate business in current dollars and gross value added of nonfinancial domestic corporate business in current and chained dollars (a) (q)"
          - name: nipa_t11500
            description: "table 1.15. price, costs, and profit per unit of real gross value added of nonfinancial domestic corporate business (a) (q)"
          - name: nipa_t11600
            description: "table 1.16. sources and uses of private enterprise income (a)"
          - name: nipa_t11701
            description: "table 1.17.1. percent change from preceding period in real gross domestic product, real gross domestic income, and other major nipa aggregates (a) (q)"
          - name: nipa_t11705
            description: "table 1.17.5. gross domestic product, gross domestic income, and other major nipa aggregates (a) (q)"
          - name: nipa_t11706
            description: "table 1.17.6. real gross domestic product, real gross domestic income, and other major nipa aggregates, chained dollars (a) (q)"
          - name: nipa_t20100
            description: "table 2.1. personal income and its disposition (a) (q)"
          - name: nipa_t20200a
            description: "table 2.2a. wages and salaries by industry (a) (q)"
          - name: nipa_t20200b
            description: "table 2.2b. wages and salaries by industry (a) (q)"
          - name: nipa_t20301
            description: "table 2.3.1. percent change from preceding period in real personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20302
            description: "table 2.3.2. contributions to percent change in real personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20303
            description: "table 2.3.3. real personal consumption expenditures by major type of product, quantity indexes (a) (q)"
          - name: nipa_t20304
            description: "table 2.3.4. price indexes for personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20305
            description: "table 2.3.5. personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20306
            description: "table 2.3.6. real personal consumption expenditures by major type of product, chained dollars (a) (q)"
          - name: nipa_t20307
            description: "table 2.3.7. percent change from preceding period in prices for personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20308
            description: "table 2.3.8. contributions to percent change in prices for personal consumption expenditures by major type of product (a) (q)"
          - name: nipa_t20311
            description: "table 2.3.11. real personal consumption expenditures by major type of product: percent change from quarter one year ago (q)"
          - name: nipa_t20401
            description: "table 2.4.1. percent change from preceding period in real personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20402
            description: "table 2.4.2. contributions to percent change in real personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20403
            description: "table 2.4.3. real personal consumption expenditures by type of product, quantity indexes (a) (q)"
          - name: nipa_t20404
            description: "table 2.4.4. price indexes for personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20405
            description: "table 2.4.5. personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20406
            description: "table 2.4.6. real personal consumption expenditures by type of product, chained dollars (a) (q)"
          - name: nipa_t20407
            description: "table 2.4.7. percent change from preceding period in prices for personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20408
            description: "table 2.4.8. contributions to percent change in prices for personal consumption expenditures by type of product (a) (q)"
          - name: nipa_t20503
            description: "table 2.5.3. real personal consumption expenditures by function, quantity indexes (a)"
          - name: nipa_t20504
            description: "table 2.5.4. price indexes for personal consumption expenditures by function (a)"
          - name: nipa_t20505
            description: "table 2.5.5. personal consumption expenditures by function (a)"
          - name: nipa_t20506
            description: "table 2.5.6. real personal consumption expenditures by function, chained dollars (a)"
          - name: nipa_t20600
            description: "table 2.6. personal income and its disposition, monthly (m)"
          - name: nipa_t20700a
            description: "table 2.7a. wages and salaries by industry, monthly (m)"
          - name: nipa_t20700b
            description: "table 2.7b. wages and salaries by industry, monthly (m)"
          - name: nipa_t20801
            description: "table 2.8.1. percent change from preceding period in real personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20802
            description: "table 2.8.2. contributions to percent change in real personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20803
            description: "table 2.8.3. real personal consumption expenditures by major type of product, monthly, quantity indexes (m)"
          - name: nipa_t20804
            description: "table 2.8.4. price indexes for personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20805
            description: "table 2.8.5. personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20806
            description: "table 2.8.6. real personal consumption expenditures by major type of product, monthly, chained dollars (m)"
          - name: nipa_t20807
            description: "table 2.8.7. percent change from preceding period in prices for personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20808
            description: "table 2.8.8. contributions to percent change in prices for personal consumption expenditures by major type of product, monthly (m)"
          - name: nipa_t20811
            description: "table 2.8.11. real personal consumption expenditures by major type of product: percent change from month one year ago (m)"
          - name: nipa_t20900
            description: "table 2.9. personal income and its disposition by households and by nonprofit institutions serving households (a)"
          - name: nipa_t21000
            description: "table 2.10. distributions of personal and disposable income for households (a)"
          - name: nipa_t30100
            description: "table 3.1. government current receipts and expenditures (a) (q)"
          - name: nipa_t30200
            description: "table 3.2. federal government current receipts and expenditures (a) (q)"
          - name: nipa_t30300
            description: "table 3.3. state and local government current receipts and expenditures (a) (q)"
          - name: nipa_t30400
            description: "table 3.4. personal current tax receipts (a)"
          - name: nipa_t30500
            description: "table 3.5. taxes on production and imports (a)"
          - name: nipa_t30600
            description: "table 3.6. contributions for government social insurance (a)"
          - name: nipa_t30700
            description: "table 3.7. government current transfer receipts (a)"
          - name: nipa_t30800
            description: "table 3.8. current surplus of government enterprises (a)"
          - name: nipa_t30901
            description: "table 3.9.1. percent change from preceding period in real government consumption expenditures and gross investment (a) (q)"
          - name: nipa_t30902
            description: "table 3.9.2. contributions to percent change in real government consumption expenditures and gross investment (a) (q)"
          - name: nipa_t30903
            description: "table 3.9.3. real government consumption expenditures and gross investment, quantity indexes (a) (q)"
          - name: nipa_t30904
            description: "table 3.9.4. price indexes for government consumption expenditures and gross investment (a) (q)"
          - name: nipa_t30905
            description: "table 3.9.5. government consumption expenditures and gross investment (a) (q)"
          - name: nipa_t30906
            description: "table 3.9.6. real government consumption expenditures and gross investment, chained dollars (a) (q)"
          - name: nipa_t31001
            description: "table 3.10.1. percent change from preceding period in real government consumption expenditures and general government gross output (a) (q)"
          - name: nipa_t31003
            description: "table 3.10.3. real government consumption expenditures and general government gross output, quantity indexes (a) (q)"
          - name: nipa_t31004
            description: "table 3.10.4. price indexes for government consumption expenditures and general government gross output (a) (q)"
          - name: nipa_t31005
            description: "table 3.10.5. government consumption expenditures and general government gross output (a) (q)"
          - name: nipa_t31006
            description: "table 3.10.6. real government consumption expenditures and general government gross output, chained dollars (a) (q)"
          - name: nipa_t31101
            description: "table 3.11.1. percent change from preceding period in real national defense consumption expenditures and gross investment by type (a) (q)"
          - name: nipa_t31102
            description: "table 3.11.2. contributions to percent change in national defense consumption expenditures and gross investment by type (a) (q)"
          - name: nipa_t31103
            description: "table 3.11.3. real national defense consumption expenditures and gross investment by type, quantity indexes (a) (q)"
          - name: nipa_t31104
            description: "table 3.11.4. price indexes for national defense consumption expenditures and gross investment by type (a) (q)"
          - name: nipa_t31105
            description: "table 3.11.5. national defense consumption expenditures and gross investment by type (a) (q)"
          - name: nipa_t31106
            description: "table 3.11.6. real national defense consumption expenditures and gross investment by type, chained dollars (a) (q)"
          - name: nipa_t31200
            description: "table 3.12. government social benefits (a)"
          - name: nipa_t31300
            description: "table 3.13. subsidies (a)"
          - name: nipa_t31400
            description: "table 3.14. government social insurance funds current receipts and expenditures (a)"
          - name: nipa_t31501
            description: "table 3.15.1. percent change from preceding period in real government consumption expenditures and gross investment by function (a)"
          - name: nipa_t31502
            description: "table 3.15.2. contributions to percent change in real government consumption expenditures and gross investment by function (a)"
          - name: nipa_t31503
            description: "table 3.15.3. real government consumption expenditures and gross investment by function, quantity indexes (a)"
          - name: nipa_t31504
            description: "table 3.15.4. price indexes for government consumption expenditures and gross investment by function (a)"
          - name: nipa_t31505
            description: "table 3.15.5. government consumption expenditures and gross investment by function (a)"
          - name: nipa_t31506
            description: "table 3.15.6. real government consumption expenditures and gross investment by function, chained dollars (a)"
          - name: nipa_t31600
            description: "table 3.16. government current expenditures by function (a)"
          - name: nipa_t31700
            description: "table 3.17. selected government current and capital expenditures by function (a)"
          - name: nipa_t31800a
            description: "table 3.18a. relation of federal government current receipts and expenditures in the national income and product accounts to the consolidated cash statement, fiscal years and quarters (a) (q)"
          - name: nipa_t31800b
            description: "table 3.18b. relation of federal government current receipts and expenditures in the national income and product accounts to the budget, fiscal years and quarters (a) (q)"
          - name: nipa_t31900
            description: "table 3.19. relation of state and local government current receipts and expenditures in the national income and product accounts to census bureau &#39;government finances&#39; data, fiscal years (a)"
          - name: nipa_t32000
            description: "table 3.20. state government current receipts and expenditures (a)"
          - name: nipa_t32100
            description: "table 3.21. local government current receipts and expenditures (a)"
          - name: nipa_t40100
            description: "table 4.1. foreign transactions in the national income and product accounts (a) (q)"
          - name: nipa_t40201
            description: "table 4.2.1. percent change from preceding period in real exports and in real imports of goods and services by type of product (a) (q)"
          - name: nipa_t40202
            description: "table 4.2.2. contributions to percent change in real exports and real imports of goods and services by type of product (a) (q)"
          - name: nipa_t40203a
            description: "table 4.2.3a. real exports and imports of goods and services by type of product, quantity indexes (a) (q)"
          - name: nipa_t40203b
            description: "table 4.2.3b. real exports and imports of goods and services by type of product, quantity indexes (a) (q)"
          - name: nipa_t40204a
            description: "table 4.2.4a. price indexes for exports and imports of goods and services by type of product (a) (q)"
          - name: nipa_t40204b
            description: "table 4.2.4b. price indexes for exports and imports of goods and services by type of product (a) (q)"
          - name: nipa_t40205a
            description: "table 4.2.5a. exports and imports of goods and services by type of product (a) (q)"
          - name: nipa_t40205b
            description: "table 4.2.5b. exports and imports of goods and services by type of product (a) (q)"
          - name: nipa_t40206b
            description: "table 4.2.6b. real exports and imports of goods and services by type of product, chained dollars (a) (q)"
          - name: nipa_t4030a
            description: "table 4.3a. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a)"
          - name: nipa_t4030b
            description: "table 4.3b. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a)"
          - name: nipa_t4030c
            description: "table 4.3c. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (a) (q)"
          - name: nipa_t50100
            description: "table 5.1. saving and investment by sector (a) (q)"
          - name: nipa_t50203
            description: "table 5.2.3. real gross and net domestic investment by major type, quantity indexes (a)"
          - name: nipa_t50205
            description: "table 5.2.5. gross and net domestic investment by major type (a)"
          - name: nipa_t50206
            description: "table 5.2.6. real gross and net domestic investment by major type, chained dollars (a)"
          - name: nipa_t50301
            description: "table 5.3.1. percent change from preceding period in real private fixed investment by type (a) (q)"
          - name: nipa_t50302
            description: "table 5.3.2. contributions to percent change in real private fixed investment by type (a) (q)"
          - name: nipa_t50303
            description: "table 5.3.3. real private fixed investment by type, quantity indexes (a) (q)"
          - name: nipa_t50304
            description: "table 5.3.4. price indexes for private fixed investment by type (a) (q)"
          - name: nipa_t50305
            description: "table 5.3.5. private fixed investment by type (a) (q)"
          - name: nipa_t50306
            description: "table 5.3.6. real private fixed investment by type, chained dollars (a) (q)"
          - name: nipa_t50401
            description: "table 5.4.1. percent change from preceding period in real private fixed investment in structures by type (a)"
          - name: nipa_t50402
            description: "table 5.4.2. contributions to percent change in real private fixed investment in structures by type (a)"
          - name: nipa_t50403
            description: "table 5.4.3. real private fixed investment in structures by type, quantity indexes (a)"
          - name: nipa_t50404
            description: "table 5.4.4. price indexes for private fixed investment in structures by type (a)"
          - name: nipa_t50405
            description: "table 5.4.5. private fixed investment in structures by type (a)"
          - name: nipa_t50406
            description: "table 5.4.6. real private fixed investment in structures by type, chained dollars (a)"
          - name: nipa_t50501
            description: "table 5.5.1. percent change from preceding period in real private fixed investment in equipment by type (a)"
          - name: nipa_t50502
            description: "table 5.5.2. contributions to percent change in real private fixed investment in equipment by type (a)"
          - name: nipa_t50503
            description: "table 5.5.3. real private fixed investment in equipment by type, quantity indexes (a)"
          - name: nipa_t50504
            description: "table 5.5.4. price indexes for private fixed investment in equipment by type (a)"
          - name: nipa_t50505
            description: "table 5.5.5. private fixed investment in equipment by type (a)"
          - name: nipa_t50506
            description: "table 5.5.6. real private fixed investment in equipment by type, chained dollars (a)"
          - name: nipa_t50601
            description: "table 5.6.1. percent change from preceding period in real private fixed investment in intellectual property products by type (a)"
          - name: nipa_t50602
            description: "table 5.6.2. contributions to percent change in private fixed investment in intellectual property products by type (a)"
          - name: nipa_t50603
            description: "table 5.6.3. real private fixed investment in intellectual property products by type, quantity indexes (a)"
          - name: nipa_t50604
            description: "table 5.6.4. price indexes for private fixed investment in intellectual property products by type (a)"
          - name: nipa_t50605
            description: "table 5.6.5. private fixed investment in intellectual property products by type (a)"
          - name: nipa_t50606
            description: "table 5.6.6. real private fixed investment in intellectual property products by type, chained dollars (a)"
          - name: nipa_t50705a
            description: "table 5.7.5a. change in private inventories by industry (a) (q)"
          - name: nipa_t50705b
            description: "table 5.7.5b. change in private inventories by industry (a) (q)"
          - name: nipa_t50706a
            description: "table 5.7.6a. change in real private inventories by industry, chained dollars (a) (q)"
          - name: nipa_t50706b
            description: "table 5.7.6b. change in real private inventories by industry, chained dollars (a) (q)"
          - name: nipa_t50805a
            description: "table 5.8.5a. private inventories and domestic final sales of business by industry (q)"
          - name: nipa_t50805b
            description: "table 5.8.5b. private inventories and domestic final sales by industry (q)"
          - name: nipa_t50806a
            description: "table 5.8.6a. real private inventories and real domestic final sales of business by industry, chained dollars (q)"
          - name: nipa_t50806b
            description: "table 5.8.6b. real private inventories and real domestic final sales by industry, chained dollars (q)"
          - name: nipa_t50809a
            description: "table 5.8.9a. implicit price deflators for private inventories by industry (q)"
          - name: nipa_t50809b
            description: "table 5.8.9b. implicit price deflators for private inventories by industry (q)"
          - name: nipa_t50903
            description: "table 5.9.3. real gross government fixed investment by type, quantity indexes (a)"
          - name: nipa_t50904
            description: "table 5.9.4. price indexes for gross government fixed investment by type (a)"
          - name: nipa_t50905
            description: "table 5.9.5. gross government fixed investment by type (a)"
          - name: nipa_t50906
            description: "table 5.9.6. real gross government fixed investment by type, chained dollars (a)"
          - name: nipa_t51000
            description: "table 5.10. changes in net stock of produced assets (fixed assets and inventories) (a)"
          - name: nipa_t51100
            description: "table 5.11. capital transfers paid and received, by sector and by type (a)"
          - name: nipa_t60100b
            description: "table 6.1b. national income without capital consumption adjustment by industry (a) (q)"
          - name: nipa_t60100c
            description: "table 6.1c. national income without capital consumption adjustment by industry (a) (q)"
          - name: nipa_t60100d
            description: "table 6.1d. national income without capital consumption adjustment by industry (a) (q)"
          - name: nipa_t60200a
            description: "table 6.2a. compensation of employees by industry (a)"
          - name: nipa_t60200b
            description: "table 6.2b. compensation of employees by industry (a)"
          - name: nipa_t60200c
            description: "table 6.2c. compensation of employees by industry (a)"
          - name: nipa_t60200d
            description: "table 6.2d. compensation of employees by industry (a)"
          - name: nipa_t60300a
            description: "table 6.3a. wages and salaries by industry (a)"
          - name: nipa_t60300b
            description: "table 6.3b. wages and salaries by industry (a)"
          - name: nipa_t60300c
            description: "table 6.3c. wages and salaries by industry (a)"
          - name: nipa_t60300d
            description: "table 6.3d. wages and salaries by industry (a)"
          - name: nipa_t60400a
            description: "table 6.4a. full-time and part-time employees by industry (a)"
          - name: nipa_t60400b
            description: "table 6.4b. full-time and part-time employees by industry (a)"
          - name: nipa_t60400c
            description: "table 6.4c. full-time and part-time employees by industry (a)"
          - name: nipa_t60400d
            description: "table 6.4d. full-time and part-time employees by industry (a)"
          - name: nipa_t60500a
            description: "table 6.5a. full-time equivalent employees by industry (a)"
          - name: nipa_t60500b
            description: "table 6.5b. full-time equivalent employees by industry (a)"
          - name: nipa_t60500c
            description: "table 6.5c. full-time equivalent employees by industry (a)"
          - name: nipa_t60500d
            description: "table 6.5d. full-time equivalent employees by industry (a)"
          - name: nipa_t60600a
            description: "table 6.6a. wages and salaries per full-time equivalent employee by industry (a)"
          - name: nipa_t60600b
            description: "table 6.6b. wages and salaries per full-time equivalent employee by industry (a)"
          - name: nipa_t60600c
            description: "table 6.6c. wages and salaries per full-time equivalent employee by industry (a)"
          - name: nipa_t60600d
            description: "table 6.6d. wages and salaries per full-time equivalent employee by industry (a)"
          - name: nipa_t60700a
            description: "table 6.7a. self-employed persons by industry (a)"
          - name: nipa_t60700b
            description: "table 6.7b. self-employed persons by industry (a)"
          - name: nipa_t60700c
            description: "table 6.7c. self-employed persons by industry (a)"
          - name: nipa_t60700d
            description: "table 6.7d. self-employed persons by industry (a)"
          - name: nipa_t60800a
            description: "table 6.8a. persons engaged in production by industry (a)"
          - name: nipa_t60800b
            description: "table 6.8b. persons engaged in production by industry (a)"
          - name: nipa_t60800c
            description: "table 6.8c. persons engaged in production by industry (a)"
          - name: nipa_t60800d
            description: "table 6.8d. persons engaged in production by industry (a)"
          - name: nipa_t60900b
            description: "table 6.9b. hours worked by full-time and part-time employees by industry (a)"
          - name: nipa_t60900c
            description: "table 6.9c. hours worked by full-time and part-time employees by industry (a)"
          - name: nipa_t60900d
            description: "table 6.9d. hours worked by full-time and part-time employees by industry (a)"
          - name: nipa_t61000b
            description: "table 6.10b. employer contributions for government social insurance by industry (a)"
          - name: nipa_t61000c
            description: "table 6.10c. employer contributions for government social insurance by industry (a)"
          - name: nipa_t61000d
            description: "table 6.10d. employer contributions for government social insurance by industry (a)"
          - name: nipa_t61100a
            description: "table 6.11a. employer contributions for employee pension and insurance funds by industry and by type (a)"
          - name: nipa_t61100b
            description: "table 6.11b. employer contributions for employee pension and insurance funds by industry and by type (a)"
          - name: nipa_t61100c
            description: "table 6.11c. employer contributions for employee pension and insurance funds by industry and by type (a)"
          - name: nipa_t61100d
            description: "table 6.11d. employer contributions for employee pension and insurance funds by industry and by type (a)"
          - name: nipa_t61200a
            description: "table 6.12a. nonfarm proprietors&#39; income by industry (a)"
          - name: nipa_t61200b
            description: "table 6.12b. nonfarm proprietors&#39; income by industry (a)"
          - name: nipa_t61200c
            description: "table 6.12c. nonfarm proprietors&#39; income by industry (a)"
          - name: nipa_t61200d
            description: "table 6.12d. nonfarm proprietors&#39; income by industry (a)"
          - name: nipa_t61300a
            description: "table 6.13a. noncorporate capital consumption allowances by industry (a)"
          - name: nipa_t61300b
            description: "table 6.13b. noncorporate capital consumption allowances by industry (a)"
          - name: nipa_t61300c
            description: "table 6.13c. noncorporate capital consumption allowances by industry (a)"
          - name: nipa_t61300d
            description: "table 6.13d. noncorporate capital consumption allowances by industry (a)"
          - name: nipa_t61400a
            description: "table 6.14a. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)"
          - name: nipa_t61400b
            description: "table 6.14b. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)"
          - name: nipa_t61400c
            description: "table 6.14c. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)"
          - name: nipa_t61400d
            description: "table 6.14d. inventory valuation adjustment to nonfarm incomes by legal form of organization and by industry (a)"
          - name: nipa_t61500a
            description: "table 6.15a. net interest by industry (a)"
          - name: nipa_t61500b
            description: "table 6.15b. net interest by industry (a)"
          - name: nipa_t61500c
            description: "table 6.15c. net interest by industry (a)"
          - name: nipa_t61500d
            description: "table 6.15d. net interest by industry (a)"
          - name: nipa_t61600a
            description: "table 6.16a. corporate profits by industry (a)"
          - name: nipa_t61600b
            description: "table 6.16b. corporate profits by industry (a) (q)"
          - name: nipa_t61600c
            description: "table 6.16c. corporate profits by industry (a) (q)"
          - name: nipa_t61600d
            description: "table 6.16d. corporate profits by industry (a) (q)"
          - name: nipa_t61700a
            description: "table 6.17a. corporate profits before tax by industry (a)"
          - name: nipa_t61700b
            description: "table 6.17b. corporate profits before tax by industry (a)"
          - name: nipa_t61700c
            description: "table 6.17c. corporate profits before tax by industry (a)"
          - name: nipa_t61700d
            description: "table 6.17d. corporate profits before tax by industry (a)"
          - name: nipa_t61800a
            description: "table 6.18a. taxes on corporate income by industry (a)"
          - name: nipa_t61800b
            description: "table 6.18b. taxes on corporate income by industry (a)"
          - name: nipa_t61800c
            description: "table 6.18c. taxes on corporate income by industry (a)"
          - name: nipa_t61800d
            description: "table 6.18d. taxes on corporate income by industry (a)"
          - name: nipa_t61900a
            description: "table 6.19a. corporate profits after tax by industry (a)"
          - name: nipa_t61900b
            description: "table 6.19b. corporate profits after tax by industry (a)"
          - name: nipa_t61900c
            description: "table 6.19c. corporate profits after tax by industry (a)"
          - name: nipa_t61900d
            description: "table 6.19d. corporate profits after tax by industry (a)"
          - name: nipa_t62000a
            description: "table 6.20a. net corporate dividend payments by industry (a)"
          - name: nipa_t62000b
            description: "table 6.20b. net corporate dividend payments by industry (a)"
          - name: nipa_t62000c
            description: "table 6.20c. net corporate dividend payments by industry (a)"
          - name: nipa_t62000d
            description: "table 6.20d. net corporate dividend payments by industry (a)"
          - name: nipa_t62100a
            description: "table 6.21a. undistributed corporate profits by industry (a)"
          - name: nipa_t62100b
            description: "table 6.21b. undistributed corporate profits by industry (a)"
          - name: nipa_t62100c
            description: "table 6.21c. undistributed corporate profits by industry (a)"
          - name: nipa_t62100d
            description: "table 6.21d. undistributed corporate profits by industry (a)"
          - name: nipa_t62200a
            description: "table 6.22a. corporate capital consumption allowances by industry (a)"
          - name: nipa_t62200b
            description: "table 6.22b. corporate capital consumption allowances by industry (a)"
          - name: nipa_t62200c
            description: "table 6.22c. corporate capital consumption allowances by industry (a)"
          - name: nipa_t62200d
            description: "table 6.22d. corporate capital consumption allowances by industry (a)"
          - name: nipa_t70100
            description: "table 7.1. selected per capita product and income series in current and chained dollars (a) (q)"
          - name: nipa_t70201a
            description: "table 7.2.1a. percent change from preceding period in real auto output (a) (q)"
          - name: nipa_t70201b
            description: "table 7.2.1b. percent change from preceding period in real motor vehicle output (a) (q)"
          - name: nipa_t70203a
            description: "table 7.2.3a. real auto output, quantity indexes (a) (q)"
          - name: nipa_t70203b
            description: "table 7.2.3b. real motor vehicle output, quantity indexes (a) (q)"
          - name: nipa_t70204a
            description: "table 7.2.4a. price indexes for auto output (a) (q)"
          - name: nipa_t70204b
            description: "table 7.2.4b. price indexes for motor vehicle output (a) (q)"
          - name: nipa_t70205a
            description: "table 7.2.5a. auto output (a) (q)"
          - name: nipa_t70205b
            description: "table 7.2.5b. motor vehicle output (a) (q)"
          - name: nipa_t70206b
            description: "table 7.2.6b. real motor vehicle output, chained dollars (a) (q)"
          - name: nipa_t70303
            description: "table 7.3.3. real farm sector output, real gross value added, and real net value added, quantity indexes (a)"
          - name: nipa_t70304
            description: "table 7.3.4. price indexes for farm sector output, gross value added, and net value added (a)"
          - name: nipa_t70305
            description: "table 7.3.5. farm sector output, gross value added, and net value added (a)"
          - name: nipa_t70306
            description: "table 7.3.6. real farm sector output, real gross value added, and real net value added, chained dollars (a)"
          - name: nipa_t70403
            description: "table 7.4.3. real housing sector output, real gross value added, and real net value added, quantity indexes (a)"
          - name: nipa_t70404
            description: "table 7.4.4. price indexes for housing sector output, gross value added, and net value added (a)"
          - name: nipa_t70405
            description: "table 7.4.5. housing sector output, gross value added, and net value added (a)"
          - name: nipa_t70406
            description: "table 7.4.6. real housing sector output, real gross value added, and real net value added, chained dollars (a)"
          - name: nipa_t70500
            description: "table 7.5. consumption of fixed capital by legal form of organization and type of income (a) (q)"
          - name: nipa_t70600
            description: "table 7.6. capital consumption adjustment by legal form of organization and type of adjustment (a)"
          - name: nipa_t70700
            description: "table 7.7. business current transfer payments by type (a)"
          - name: nipa_t70800
            description: "table 7.8. supplements to wages and salaries by type (a)"
          - name: nipa_t70900
            description: "table 7.9. rental income of persons by legal form of organization and by type of income (a)"
          - name: nipa_t71000
            description: "table 7.10. dividends paid and received by sector (a)"
          - name: nipa_t71100
            description: "table 7.11. interest paid and received by sector and legal form of organization (a)"
          - name: nipa_t71200
            description: "table 7.12. imputations in the national income and product accounts (a)"
          - name: nipa_t71300
            description: "table 7.13. relation of consumption of fixed capital in the national income and product accounts to depreciation and amortization as published by the internal revenue service (a)"
          - name: nipa_t71400
            description: "table 7.14. relation of nonfarm proprietors&#39; income in the national income and product accounts to corresponding measures as published by the internal revenue service (a)"
          - name: nipa_t71500
            description: "table 7.15. relation of net farm income in the national income and product accounts to net farm income as published by the u.s. department of agriculture (a)"
          - name: nipa_t71600
            description: "table 7.16. relation of corporate profits, taxes, and dividends in the national income and product accounts to corresponding measures as published by the internal revenue service (a)"
          - name: nipa_t71700
            description: "table 7.17. relation of monetary interest paid and received in the national income and product accounts to corresponding measures as published by the internal revenue service (a)"
          - name: nipa_t71800
            description: "table 7.18. relation of wages and salaries in the national income and product accounts to wages and salaries as published by the bureau of labor statistics (a)"
          - name: nipa_t71900
            description: "table 7.19. comparison of income and outlays of nonprofit institutions serving households with revenue and expenses as published by the internal revenue service (a)"
          - name: nipa_t72000
            description: "table 7.20. transactions of defined benefit and defined contribution pension plans (a)"
          - name: nipa_t72100
            description: "table 7.21. transactions of defined benefit pension plans (a)"
          - name: nipa_t72200
            description: "table 7.22. transactions of private defined benefit pension plans (a)"
          - name: nipa_t72300
            description: "table 7.23. transactions of federal government defined benefit pension plans (a)"
          - name: nipa_t72400
            description: "table 7.24. transactions of state and local government defined benefit pension plans (a)"
          - name: nipa_t72500
            description: "table 7.25. transactions of defined contribution pension plans (a)"
          - name: nipa_t80103
            description: "table 8.1.3. real gross domestic product, quantity indexes, not seasonally adjusted (q)"
          - name: nipa_t80104
            description: "table 8.1.4. price indexes for gross domestic product, not seasonally adjusted (q)"
          - name: nipa_t80105
            description: "table 8.1.5. gross domestic product, not seasonally adjusted (q)"
          - name: nipa_t80106
            description: "table 8.1.6. real gross domestic product, chained dollars, not seasonally adjusted (q)"
          - name: nipa_t80111
            description: "table 8.1.11. real gross domestic product: percent change from quarter one year ago, not seasonally adjusted (q)"
          - name: nipa_t80200
            description: "table 8.2. gross domestic income by type of income, not seasonally adjusted (q)"
          - name: nipa_t80300
            description: "table 8.3. federal government current receipts and expenditures, not seasonally adjusted (q)"
          - name: nipa_t80400
            description: "table 8.4. state and local government current receipts and expenditures, not seasonally adjusted (q)"
          - name: niunderlyingdetail_u001a
            description: "table 1au. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 1996 dollars, 1967-96, sic] (q) (m)"
          - name: niunderlyingdetail_u001a2
            description: "table 1au2. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 2017 dollars, 1967-96, sic] (q) (m)"
          - name: niunderlyingdetail_u001b
            description: "table 1bu. real manufacturing and trade inventories, seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u001bc
            description: "table 1buc. current dollar manufacturing and trade inventories, seasonally adjusted, end of period [1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u002au
            description: "table 2au. real manufacturing and trade sales, seasonally adjusted at monthly rate [chained 1996 dollars, 1967-96, sic] (q) (m)"
          - name: niunderlyingdetail_u002aui
            description: "table 2aui. implicit price deflators for manufacturing and trade sales [index base 1996, 1967-96, sic] (q) (m)"
          - name: niunderlyingdetail_u002bu
            description: "table 2bu. real manufacturing and trade sales, seasonally adjusted at monthly rate [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u002bui
            description: "table 2bui. implicit price deflators for manufacturing and trade sales [index base 2017, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u003au
            description: "table 3au. real inventory-sales ratios for manufacturing and trade, seasonally adjusted [based on chained 1996 dollars, 1967-96, sic] (q) (m)"
          - name: niunderlyingdetail_u003bu
            description: "table 3bu. real inventory-sales ratios for manufacturing and trade, seasonally adjusted [based on chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u004a1
            description: "table 4au1. real manufacturing inventories, by stage of fabrication (materials and supplies), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)"
          - name: niunderlyingdetail_u004a2
            description: "table 4au2. real manufacturing inventories, by stage of fabrication (works-in-process), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)"
          - name: niunderlyingdetail_u004a3
            description: "table 4au3. real manufacturing inventories, by stage of fabrication (finished goods), seasonally adjusted, end of period [chained 2017 dollars, 1967-97 forward, sic] (q) (m)"
          - name: niunderlyingdetail_u004b1
            description: "table 4bu1. real manufacturing inventories, by stage of fabrication (materials and supplies), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u004b2
            description: "table 4bu2. real manufacturing inventories, by stage of fabrication (work-in-process), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u004b3
            description: "table 4bu3. real manufacturing inventories, by stage of fabrication (finished goods), seasonally adjusted, end of period [chained 2017 dollars, 1997 forward, naics] (a) (q) (m)"
          - name: niunderlyingdetail_u00500
            description: "table 5u. bea retail and food service sales (a) (q) (m)"
          - name: niunderlyingdetail_u00600
            description: "table 6u. real bea retail and food service sales (a) (q) (m)"
          - name: niunderlyingdetail_u00700
            description: "table 7u. chain-type price indexes for bea retail and food service sales (a) (q) (m)"
          - name: niunderlyingdetail_u20304
            description: "table 2.3.4u. price indexes for personal consumption expenditures by major type of product and by major function (a) (q) (m)"
          - name: niunderlyingdetail_u20305
            description: "table 2.3.5u. personal consumption expenditures by major type of product and by major function (a) (q) (m)"
          - name: niunderlyingdetail_u20306
            description: "table 2.3.6u. real personal consumption expenditures by major type of product and by major function (a) (q) (m)"
          - name: niunderlyingdetail_u20403
            description: "table 2.4.3u. real personal consumption expenditures by type of product, quantity indexes (a) (q) (m)"
          - name: niunderlyingdetail_u20404
            description: "table 2.4.4u. price indexes for personal consumption expenditures by type of product (a) (q) (m)"
          - name: niunderlyingdetail_u20405
            description: "table 2.4.5u. personal consumption expenditures by type of product (a) (q) (m)"
          - name: niunderlyingdetail_u20406
            description: "table 2.4.6u. real personal consumption expenditures by type of product, chained dollars (a) (q) (m)"
          - name: niunderlyingdetail_u30400
            description: "table 3.4u. personal current tax receipts (q)"
          - name: niunderlyingdetail_u30500
            description: "table 3.5u. taxes on production and imports (q)"
          - name: niunderlyingdetail_u30600
            description: "table 3.6u. contributions for government social insurance (q)"
          - name: niunderlyingdetail_u30700
            description: "table 3.7u. government current transfer receipts (q)"
          - name: niunderlyingdetail_u30800
            description: "table 3.8u. current surplus of government enterprises (q)"
          - name: niunderlyingdetail_u31200
            description: "table 3.12u. government social benefits (q)"
          - name: niunderlyingdetail_u31300
            description: "table 3.13u. subsidies (q)"
          - name: niunderlyingdetail_u32400
            description: "table 3.24u. federal grants-in-aid to state and local governments (q)"
          - name: niunderlyingdetail_u32500
            description: "table 3.25u. compensation of general government employees (a)"
          - name: niunderlyingdetail_u4030b
            description: "table 4.3bu. relation of foreign transactions in the national income and product accounts to the corresponding items in the international transactions accounts (q)"
          - name: niunderlyingdetail_u50203
            description: "table 5.2.3u. real gross and net domestic investment by major type, quantity indexes (q)"
          - name: niunderlyingdetail_u50205
            description: "table 5.2.5u. gross and net domestic investment by major type (q)"
          - name: niunderlyingdetail_u50206
            description: "table 5.2.6u. real gross and net domestic investment by major type, chained dollars (q)"
          - name: niunderlyingdetail_u50404
            description: "table 5.4.4u. price indexes for private fixed investment in structures by type (a) (q)"
          - name: niunderlyingdetail_u50405
            description: "table 5.4.5u. private fixed investment in structures by type (a) (q)"
          - name: niunderlyingdetail_u50406
            description: "table 5.4.6u. private fixed investment in structures by type, chained dollars (a) (q)"
          - name: niunderlyingdetail_u50504
            description: "table 5.5.4u. price indexes for private fixed investment in equipment  by type (a) (q)"
          - name: niunderlyingdetail_u50505
            description: "table 5.5.5u. private fixed investment in equipment  by type (a) (q)"
          - name: niunderlyingdetail_u50506
            description: "table 5.5.6u. private fixed investment in equipment  by type, chained dollars (a) (q)"
          - name: niunderlyingdetail_u50705am1
            description: "table 5.7.5am1. change in private inventories by industry (m)"
          - name: niunderlyingdetail_u50705am2
            description: "table 5.7.5am2. change in book value by industry (m)"
          - name: niunderlyingdetail_u50705am3
            description: "table 5.7.5am3. inventory valuation adjustment by industry (m)"
          - name: niunderlyingdetail_u50705au1
            description: "table 5.7.5au1. change in private inventories by industry (q)"
          - name: niunderlyingdetail_u50705au2
            description: "table 5.7.5au2. change in book value by industry (q)"
          - name: niunderlyingdetail_u50705au3
            description: "table 5.7.5au3. inventory valuation adjustment by industry (q)"
          - name: niunderlyingdetail_u50705bm1
            description: "table 5.7.5bm1. change in private inventories by industry (m)"
          - name: niunderlyingdetail_u50705bm2
            description: "table 5.7.5bm2. change in book value by industry (m)"
          - name: niunderlyingdetail_u50705bm3
            description: "table 5.7.5bm3. inventory valuation adjustment by industry (m)"
          - name: niunderlyingdetail_u50705bu1
            description: "table 5.7.5bu1. change in private inventories by industry (a) (q)"
          - name: niunderlyingdetail_u50705bu2
            description: "table 5.7.5bu2. change in book value by industry (a) (q)"
          - name: niunderlyingdetail_u50705bu3
            description: "table 5.7.5bu3. inventory valuation adjustment by industry (a) (q)"
          - name: niunderlyingdetail_u50706am
            description: "table 5.7.6am. change in real private inventories by industry (m)"
          - name: niunderlyingdetail_u50706au
            description: "table 5.7.6au. change in real private inventories by industry (q)"
          - name: niunderlyingdetail_u50706bm
            description: "table 5.7.6bm. change in real private inventories by industry (m)"
          - name: niunderlyingdetail_u50706bu
            description: "table 5.7.6bu. change in real private inventories by industry (a) (q)"
          - name: niunderlyingdetail_u51100
            description: "table 5.11u. capital transfers paid and received, by sector and by type (q)"
          - name: niunderlyingdetail_u70204
            description: "table 7.2.4u. price indexes for motor vehicle output (a) (q)"
          - name: niunderlyingdetail_u70205
            description: "table 7.2.5u. motor vehicle output (a) (q)"
          - name: niunderlyingdetail_u70205s
            description: "table 7.2.5s. auto and truck unit sales, production, inventories, expenditures, and price (m)"
          - name: niunderlyingdetail_u70206
            description: "table 7.2.6u. real motor vehicle output, chained dollars (a) (q)"
          - name: niunderlyingdetail_u90100
            description: "table 9.1u. reconciliation of percent change in the cpi with percent change in the pce price index (q) (m)"
          - name: niunderlyingdetail_u90200
            description: "table 9.2u. final sales of domestic computers (a) (q)"
          - name: niunderlyingdetail_u90300
            description: "table 9.3u. gross domestic product and final sales of software (a)"
          - name: niunderlyingdetail_u90400
            description: "table 9.4u. software investment and prices (a)"
          - name: niunderlyingdetail_u90500
            description: "table 9.5u. contributions to percent change in real gross domestic product from final sales of computers, software, and communications equipment (a)"
          # Dataset mne has no tables
          - name: fixedassets_faat101
            description: "table 1.1. current-cost net stock of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat102
            description: "table 1.2. chain-type quantity indexes for net stock of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat103
            description: "table 1.3. current-cost depreciation of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat104
            description: "table 1.4. chain-type quantity indexes for depreciation of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat105
            description: "table 1.5. investment in fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat106
            description: "table 1.6. chain-type quantity indexes for investment in fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat107
            description: "table 1.7. current-cost other changes in volume of assets for fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat108
            description: "table 1.8. historical-cost other changes in volume of assets for fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat109
            description: "table 1.9. current-cost average age at yearend of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat201
            description: "table 2.1. current-cost net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat202
            description: "table 2.2. chain-type quantity indexes for net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat203
            description: "table 2.3. historical-cost net stock of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat204
            description: "table 2.4. current-cost depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat205
            description: "table 2.5. chain-type quantity indexes for depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat206
            description: "table 2.6. historical-cost depreciation of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat207
            description: "table 2.7. investment in private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat208
            description: "table 2.8. chain-type quantity indexes for investment in private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat209
            description: "table 2.9. current-cost average age at yearend of private fixed assets, equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat210
            description: "table 2.10. historical-cost average age at yearend of private fixed assets,  equipment, structures, and intellectual property products by type (a)"
          - name: fixedassets_faat301e
            description: "table 3.1e. current-cost net stock of private equipment by industry (a)"
          - name: fixedassets_faat301esi
            description: "table 3.1esi. current-cost net stock of private fixed assets by industry (a)"
          - name: fixedassets_faat301i
            description: "table 3.1i. current-cost net stock of intellectual property products by industry (a)"
          - name: fixedassets_faat301s
            description: "table 3.1s. current-cost net stock of private structures by industry (a)"
          - name: fixedassets_faat302e
            description: "table 3.2e. chain-type quantity indexes for net stock of private equipment by industry (a)"
          - name: fixedassets_faat302esi
            description: "table 3.2esi. chain-type quantity indexes for net stock of private fixed assets by industry (a)"
          - name: fixedassets_faat302i
            description: "table 3.2i. chain-type quantity indexes for net stock of intellectual property products by industry (a)"
          - name: fixedassets_faat302s
            description: "table 3.2s. chain-type quantity indexes for net stock of private structures by industry (a)"
          - name: fixedassets_faat303e
            description: "table 3.3e. historical-cost net stock of private equipment by industry (a)"
          - name: fixedassets_faat303esi
            description: "table 3.3esi. historical-cost net stock of private fixed assets by industry (a)"
          - name: fixedassets_faat303i
            description: "table 3.3i. historical-cost net stock of private intellectual property products by industry (a)"
          - name: fixedassets_faat303s
            description: "table 3.3s. historical-cost net stock of private structures by industry (a)"
          - name: fixedassets_faat304e
            description: "table 3.4e. current-cost depreciation of private equipment by industry (a)"
          - name: fixedassets_faat304esi
            description: "table 3.4esi. current-cost depreciation of private fixed assets by industry (a)"
          - name: fixedassets_faat304i
            description: "table 3.4i. current-cost depreciation of private intellectual property products by industry (a)"
          - name: fixedassets_faat304s
            description: "table 3.4s. current-cost depreciation of private structures by industry (a)"
          - name: fixedassets_faat305e
            description: "table 3.5e. chain-type quantity indexes for depreciation of private equipment by industry (a)"
          - name: fixedassets_faat305esi
            description: "table 3.5esi. chain-type quantity indexes for depreciation of private fixed assets by industry (a)"
          - name: fixedassets_faat305i
            description: "table 3.5i. chain-type quantity indexes for depreciation of private intellectual property products by industry (a)"
          - name: fixedassets_faat305s
            description: "table 3.5s. chain-type quantity indexes for depreciation of private structures by industry (a)"
          - name: fixedassets_faat306e
            description: "table 3.6e. historical-cost depreciation of private equipment by industry (a)"
          - name: fixedassets_faat306esi
            description: "table 3.6esi. historical-cost depreciation of private fixed assets by industry (a)"
          - name: fixedassets_faat306i
            description: "table 3.6i. historical-cost depreciation of private intellectual property products by industry (a)"
          - name: fixedassets_faat306s
            description: "table 3.6s. historical-cost depreciation of private structures by industry (a)"
          - name: fixedassets_faat307e
            description: "table 3.7e. investment in private equipment by industry (a)"
          - name: fixedassets_faat307esi
            description: "table 3.7esi. investment in private fixed assets by industry (a)"
          - name: fixedassets_faat307i
            description: "table 3.7i. investment in private intellectual property products by industry (a)"
          - name: fixedassets_faat307s
            description: "table 3.7s. investment in private structures by industry (a)"
          - name: fixedassets_faat308e
            description: "table 3.8e. chain-type quantity indexes for investment in private equipment by industry (a)"
          - name: fixedassets_faat308esi
            description: "table 3.8esi. chain-type quantity indexes for investment in private fixed assets by industry (a)"
          - name: fixedassets_faat308i
            description: "table 3.8i. chain-type quantity indexes for investment in private intellectual property products by industry (a)"
          - name: fixedassets_faat308s
            description: "table 3.8s. chain-type quantity indexes for investment in private structures by  industry (a)"
          - name: fixedassets_faat309e
            description: "table 3.9e. current-cost average age at yearend of private equipment by industry (a)"
          - name: fixedassets_faat309esi
            description: "table 3.9esi. current-cost average age at yearend of private fixed assets by industry (a)"
          - name: fixedassets_faat309i
            description: "table 3.9i. current-cost average age at yearend of private intellectual property products by industry (a)"
          - name: fixedassets_faat309s
            description: "table 3.9s. current-cost average age at yearend of private structures by industry (a)"
          - name: fixedassets_faat310e
            description: "table 3.10e. historical-cost average age at yearend of private equipment by industry (a)"
          - name: fixedassets_faat310esi
            description: "table 3.10esi. historical-cost average age at yearend of private fixed assets by industry (a)"
          - name: fixedassets_faat310i
            description: "table 3.10i. historical-cost average age at yearend of private intellectual property products by industry (a)"
          - name: fixedassets_faat310s
            description: "table 3.10s. historical-cost average age at yearend of private structures by industry (a)"
          - name: fixedassets_faat401
            description: "table 4.1. current-cost net stock of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat402
            description: "table 4.2. chain-type quantity indexes for net stock of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat403
            description: "table 4.3. historical-cost net stock of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat404
            description: "table 4.4. current-cost depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat405
            description: "table 4.5. chain-type quantity indexes for depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat406
            description: "table 4.6. historical-cost depreciation of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat407
            description: "table 4.7. investment in private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat408
            description: "table 4.8. chain-type quantity indexes for investment in private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat409
            description: "table 4.9. current-cost average age at yearend of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat410
            description: "table 4.10. historical-cost average age at yearend of private nonresidential fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat501
            description: "table 5.1. current-cost net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat502
            description: "table 5.2. chain-type quantity indexes for net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat503
            description: "table 5.3. historical-cost net stock of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat504
            description: "table 5.4. current-cost depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat505
            description: "table 5.5. chain-type quantity indexes for depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat506
            description: "table 5.6. historical-cost depreciation of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat507
            description: "table 5.7. investment in residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat508
            description: "table 5.8. chain-type quantity indexes for investment in residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat509
            description: "table 5.9. current-cost average age at yearend of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat510
            description: "table 5.10. historical-cost average age at yearend of residential fixed assets by type of owner, legal form of organization, and tenure group (a)"
          - name: fixedassets_faat601
            description: "table 6.1. current-cost net stock of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat602
            description: "table 6.2. chain-type quantity indexes for net stock of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat603
            description: "table 6.3. historical-cost net stock of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat604
            description: "table 6.4. current-cost depreciation of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat605
            description: "table 6.5. chain-type quantity indexes for depreciation of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat606
            description: "table 6.6. historical-cost depreciation of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat607
            description: "table 6.7. investment in private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat608
            description: "table 6.8. chain-type quantity indexes for investment in private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat609
            description: "table 6.9. current-cost average age at yearend of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat610
            description: "table 6.10. historical-cost average age at yearend of private fixed assets by industry group and legal form of organization (a)"
          - name: fixedassets_faat701
            description: "table 7.1. current-cost net stock of government fixed assets (a)"
          - name: fixedassets_faat702
            description: "table 7.2. chain-type quantity indexes for net stock of government fixed assets (a)"
          - name: fixedassets_faat703
            description: "table 7.3. current-cost depreciation of government fixed assets (a)"
          - name: fixedassets_faat704
            description: "table 7.4. chain-type quantity indexes for depreciation of government fixed assets (a)"
          - name: fixedassets_faat705
            description: "table 7.5. investment in government fixed assets (a)"
          - name: fixedassets_faat706
            description: "table 7.6. chain-type quantity indexes for investment in government fixed assets (a)"
          - name: fixedassets_faat707
            description: "table 7.7. current-cost average age at yearend of government fixed assets (a)"
          - name: fixedassets_faat801
            description: "table 8.1. current-cost net stock of consumer durable goods (a)"
          - name: fixedassets_faat802
            description: "table 8.2. chain-type quantity indexes for net stock of consumer durable goods (a)"
          - name: fixedassets_faat803
            description: "table 8.3. historical-cost net stock of consumer durable goods (a)"
          - name: fixedassets_faat804
            description: "table 8.4. current-cost depreciation of consumer durable goods (a)"
          - name: fixedassets_faat805
            description: "table 8.5. chain-type quantity indexes for depreciation of consumer durable goods (a)"
          - name: fixedassets_faat806
            description: "table 8.6. historical-cost depreciation of consumer durable goods (a)"
          - name: fixedassets_faat807
            description: "table 8.7. investment in consumer durable goods (a)"
          - name: fixedassets_faat808
            description: "table 8.8. chain-type quantity indexes for investment in consumer durable goods (a)"
          - name: fixedassets_faat809
            description: "table 8.9. current-cost average age at yearend of consumer durable goods (a)"
          - name: fixedassets_faat810
            description: "table 8.10. historical-cost average age at yearend of consumer durable goods (a)"
          - name: fixedassets_faat901
            description: "table 9.1. real net stock of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat902
            description: "table 9.2. real depreciation of fixed assets and consumer durable goods (a)"
          - name: fixedassets_faat903
            description: "table 9.3. real investment in fixed assets and consumer durable goods (a)"
          # Dataset ita has no tables
          # Dataset iip has no tables
          # Dataset inputoutput has no tables
          # Dataset intlservtrade has no tables
          # Dataset intlservsta has no tables
          # Dataset gdpbyindustry has no tables
          # Dataset underlyinggdpbyindustry has no tables
          # Dataset apidatasetmetadata has no tables

================
File: dbt/econdash/.gitignore
================
target/
dbt_packages/
logs/

================
File: dbt/econdash/dbt_project.yml
================
# Name your project! Project names should contain only lowercase characters
# and underscores. A good package name should reflect your organization's
# name or the intended use of these models
name: 'econdash'
version: '1.0.0'

# This setting configures which "profile" dbt uses for this project.
profile: 'econdash'

# These configurations specify where dbt should look for different types of files.
# The `model-paths` config, for example, states that models in this project can be
# found in the "models/" directory. You probably won't need to change these!
model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

clean-targets:         # directories to be removed by `dbt clean`
  - "target"
  - "dbt_packages"

vars:
  bea_datasets: "{{ fromyaml(bea_datasets_yaml()).bea_datasets }}"

# on-run-start: "{{ 'python scripts/write_sources.py' }}"

# Configuring models
# Full documentation: https://docs.getdbt.com/docs/configuring-models

# In this example config, we tell dbt to build all models in the example/
# directory as views. These settings can be overridden in the individual model
# files using the `{{ config(...) }}` macro.
models:
  econdash:
    # Config indicated by + and applies to all files under models/example/
    example:
      +materialized: view

================
File: dbt/econdash/README.md
================
Welcome to your new dbt project!

### Using the starter project

Try running the following commands:
- dbt run
- dbt test


### Resources:
- Learn more about dbt [in the docs](https://docs.getdbt.com/docs/introduction)
- Check out [Discourse](https://discourse.getdbt.com/) for commonly asked questions and answers
- Join the [chat](https://community.getdbt.com/) on Slack for live discussions and support
- Find [dbt events](https://events.getdbt.com) near you
- Check out [the blog](https://blog.getdbt.com/) for the latest news on dbt's development and best practices

================
File: dbt/.user.yml
================
id: 1ce35d51-a546-46fa-9410-018b0483fcef

================
File: dbt/profiles.yml
================
econdash:
  outputs:
    dev:
      dbname: airflow
      host: postgres #localhost for dev
      pass: airflow
      port: 5432
      schema: econdash
      threads: 1
      type: postgres
      user: airflow
  target: dev

================
File: scripts/write_dbt_metadata_table.py
================
import yaml
from jinja2 import Template

import yaml

# Load the original YAML file
with open('/Users/glennharless/dev/EconDash/airflow/stream_configs/bea_config.yml', 'r') as file:
    bea_config = yaml.safe_load(file)

# Create a list to hold the cleaned datasets
cleaned_datasets = []

# Iterate over the datasets and remove entries without a description or table name
for dataset in bea_config['bea_datasets']:
    if 'tables' in dataset['api']:
        cleaned_tables = [
            table for table in dataset['api']['tables']
            if table.get('table_name') and table.get('description')
        ]
        dataset['api']['tables'] = cleaned_tables
    cleaned_datasets.append(dataset)

# Replace the original datasets with the cleaned ones
bea_config['bea_datasets'] = cleaned_datasets

# Write the cleaned configuration back to a new YAML file
with open('/Users/glennharless/dev/EconDash/airflow/stream_configs/clean_bea_config.yml', 'w') as file:
    yaml.safe_dump(bea_config, file, default_flow_style=False)


def generate_sql_from_yaml(yaml_path, output_sql_path):
    # Read the YAML file
    with open(yaml_path, 'r') as file:
        parsed_yaml = yaml.safe_load(file)

    # Filter out datasets without tables
    filtered_datasets = [dataset for dataset in parsed_yaml['bea_datasets'] if 'tables' in dataset['api'] and dataset['api']['tables']]

    # Jinja2 template for generating SQL
    template_str = """
with parsed_data as (
    {% for dataset in datasets %}
        {% for table in dataset['api']['tables'] %}
            select
                '{{ dataset['name'].replace("'", "''").lower() }}' as dataset_name,
                '{{ table['table_name'].replace("'", "''").lower() }}' as table_name,
                '{{ table['description'].replace("'", "''").lower() }}' as table_description
            {% if not loop.last %} union all {% endif %}
        {% endfor %}
        {% if not loop.last %} union all {% endif %}
    {% endfor %}
)
select * from parsed_data;
"""

    # Create a Jinja2 template
    template = Template(template_str)

    # Render the template with the filtered YAML data
    sql_query = template.render(datasets=filtered_datasets)

    # Write the generated SQL query to the specified file
    with open(output_sql_path, 'w') as file:
        file.write(sql_query)

# Paths
yaml_path = '/Users/glennharless/dev/EconDash/airflow/stream_configs/clean_bea_config.yml'
output_sql_path = '/Users/glennharless/dev/EconDash/dbt/econdash/models/bea_datasets_metadata.sql'

# Generate the SQL and write to file
generate_sql_from_yaml(yaml_path, output_sql_path)

================
File: scripts/write_sources.py
================
import os
from jinja2 import Environment, FileSystemLoader, select_autoescape
import yaml

# Define the path to your dbt project and the sources.yml file
dbt_project_path = os.path.join(os.getcwd(), 'dbt/econdash')
macros_path = os.path.join(dbt_project_path, 'macros')
sources_yml_path = os.path.join(dbt_project_path, 'models', 'sources.yml')

# Print the absolute paths for debugging
print("DBT project path:", dbt_project_path)
print("Macros path:", macros_path)
print("Sources YML path:", sources_yml_path)

# List files in the macros directory for debugging
print("Files in macros directory:", os.listdir(macros_path))

# Load the environment and the template file
env = Environment(
    loader=FileSystemLoader(macros_path),
    autoescape=select_autoescape(['sql'])
)

# Debug: Check if the template file exists
template_file = 'generate_sources_template.sql'
template_path = os.path.join(macros_path, template_file)
if os.path.exists(template_path):
    print(f"Template file '{template_file}' exists.")
else:
    print(f"Template file '{template_file}' does NOT exist.")

# Load the template
template = env.get_template(template_file)

# Load the variables from the YAML file
with open('airflow/stream_configs/bea_config.yml') as f:
    bea_config = yaml.safe_load(f)

# Debugging output
print("BEA Config:")
print(bea_config['bea_datasets'][0].keys())
print(bea_config['bea_datasets'][0]['api'].keys())

# Ensure 'tables' is nested within 'api' in each dataset
# convert table names and dataset name to lowercawe
cleaned_datasets = []
for dataset in bea_config['bea_datasets']:
    # convert dataset.name to lower
    dataset['name'] = dataset['name'].lower()
    if 'tables' in dataset['api']:
        cleaned_tables = [
            table for table in dataset['api']['tables']
            if table.get('table_name') and table.get('description')
        ]
        # lowercase table_name and description
        for table in cleaned_tables:
            table['table_name'] = table['table_name'].lower()
            table['description'] = table['description'].lower()

        dataset['api']['tables'] = cleaned_tables
    cleaned_datasets.append(dataset)

# Render the template with the variables
output = template.render(bea_datasets=bea_config['bea_datasets'])

# Print the output to debug
print("Generated sources.yml Content:")
print(output)

# Save the rendered output to the sources.yml file
with open(sources_yml_path, 'w') as f:
    f.write(output)

================
File: web/app.py
================
import streamlit as st
import pandas as pd
import plotly.express as px
from sqlalchemy import create_engine
# import openai
from openai import OpenAI
from dotenv import load_dotenv
import os

# Load environment variables from .env file
load_dotenv()


# Function to fetch data from PostgreSQL
def fetch_data(table_name):
    engine = create_engine(f"postgresql://{os.getenv('POSTGRES_USER')}:{os.getenv('POSTGRES_PASSWORD')}@{os.getenv('POSTGRES_HOST')}:{os.getenv('POSTGRES_PORT')}/{os.getenv('POSTGRES_DB')}")
    return pd.read_sql(f'SELECT * FROM {table_name}', engine)

# Fetch data for each table
nipa_df = fetch_data('econdash.base_nipa')
underlying_detail_df = fetch_data('econdash.base_underlyingasset')
fixed_asset_df = fetch_data('econdash.base_fixedassets')

# Streamlit app
st.title('BEA Data Visualization')

# Select dataset to visualize
dataset = st.selectbox('Select Dataset', ['NIPA', 'Underlying Detail', 'Fixed Asset'])

# Depending on the selection, update the dataframe
if dataset == 'NIPA':
    df = nipa_df
elif dataset == 'Underlying Detail':
    df = underlying_detail_df
elif dataset == 'Fixed Asset':
    df = fixed_asset_df


# Select metric to visualize
metrics = ['All'] + df['metric_name'].unique().tolist()
metric = st.selectbox('Select Metric', metrics)

# Select description to compare
descriptions = ['All'] + df['linedescription'].unique().tolist()
description = st.selectbox('Select Description', descriptions)

# Filter data based on the selected metric and description
if metric != 'All':
    filtered_df = df[df['metric_name'] == metric]
else:
    filtered_df = df

if description != 'All':
    filtered_df = filtered_df[filtered_df['linedescription'] == description]

# Add additional filtering by category or group (example: 'category')
if 'category' in filtered_df.columns:
    categories = ['All'] + filtered_df['category'].unique().tolist()
    category = st.selectbox('Select Category', categories)
    if category != 'All':
        filtered_df = filtered_df[filtered_df['category'] == category]

# Plot the data
fig = px.line(filtered_df, x='timeperiod', y='datavalue', title=f'{metric} over Time')
st.plotly_chart(fig)


# Set OpenAI API key from environment variable
client = OpenAI(
    # This is the default and can be omitted
    api_key=os.environ.get("OPENAI_API_KEY"),
)

# Add LLM integration for insights
def generate_insights(data):
    prompt = f"Provide insights for the following data:\n{data.to_string()}"
    try:
        response = client.chat.completions.create(
            model="gpt-3.5-turbo",
            messages=[
                {"role": "system", "content": "You are a data analyst."},
                {"role": "user", "content": prompt}
            ]
        )
        return response.choices[0].message['content'].strip()
    except Exception as e:
        if 'insufficient_quota' in str(e):
            return "Rate limit exceeded. Please check your OpenAI quota and try again later."
        else:
            return f"An error occurred: {e}"

insights = generate_insights(filtered_df)
st.write(insights)


# Fetch and display OpenAI API usage
def fetch_quota_info():
    try:
        usage = client.Usage.retrieve()
        quota_info = {
            "Total Quota": usage['total_tokens'] if 'total_tokens' in usage else 'N/A',
            "Used Quota": usage['used_tokens'] if 'used_tokens' in usage else 'N/A',
        }
        return quota_info
    except Exception as e:
        return {"Error": str(e)}

quota_info = fetch_quota_info()
st.sidebar.title("OpenAI Quota Information")
for key, value in quota_info.items():
    st.sidebar.write(f"{key}: {value}")

================
File: web/Dockerfile
================
# Use an official Python runtime as a parent image
FROM python:3.9-slim

# Set the working directory in the container
WORKDIR /usr/src/app

# Install system packages required for Python C extensions
RUN apt-get update && apt-get install -y \
    gcc \
    python3-dev \
    && rm -rf /var/lib/apt/lists/*

# Copy the current directory contents into the container at /usr/src/app
COPY . /usr/src/app

# Install any needed packages specified in requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Make port 8501 available to the world outside this container (Streamlit default port)
EXPOSE 8501

# Define environment variable
ENV NAME World

# Run Streamlit app when the container launches
CMD ["streamlit", "run", "app.py", "--server.port=8501", "--server.address=0.0.0.0"]

================
File: web/requirements.txt
================
flask==3.0.3
requests==2.31.0
beautifulsoup4==4.9.3
psycopg2-binary==2.9.9
pandas==2.2.2
numpy==1.26.4
SQLAlchemy==2.0.30
scikit-learn==1.4.2
matplotlib==3.8.4
matplotlib-inline==0.1.7
seaborn==0.13.2
notebook==7.1.3
statsmodels==0.14.2
streamlit==1.35.0
openai==1.30.3
python-dotenv==1.0.1
plotly==5.22.0

================
File: docker-compose.yaml
================
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#

# Basic Airflow cluster configuration for CeleryExecutor with Redis and PostgreSQL.
#
# WARNING: This configuration is for local development. Do not use it in a production deployment.
#
# This configuration supports basic configuration using environment variables or an .env file
# The following variables are supported:
#
# AIRFLOW_IMAGE_NAME           - Docker image name used to run Airflow.
#                                Default: apache/airflow:2.6.1
# AIRFLOW_UID                  - User ID in Airflow containers
#                                Default: 50000
# AIRFLOW_PROJ_DIR             - Base path to which all the files will be volumed.
#                                Default: .
# Those configurations are useful mostly in case of standalone testing/running Airflow in test/try-out mode
#
# _AIRFLOW_WWW_USER_USERNAME   - Username for the administrator account (if requested).
#                                Default: airflow
# _AIRFLOW_WWW_USER_PASSWORD   - Password for the administrator account (if requested).
#                                Default: airflow
# _PIP_ADDITIONAL_REQUIREMENTS - Additional PIP requirements to add when starting all containers.
#                                Use this option ONLY for quick checks. Installing requirements at container
#                                startup is done EVERY TIME the service is started.
#                                A better way is to build a custom image or extend the official image
#                                as described in https://airflow.apache.org/docs/docker-stack/build.html.
#                                Default: ''
#
# Feel free to modify this file to suit your needs.
---
version: '3.8'
x-airflow-common:
  &airflow-common
  # In order to add custom dependencies or upgrade provider packages you can use your extended image.
  # Comment out the existing image line
  # image: ${AIRFLOW_IMAGE_NAME:-apache/airflow:2.6.1}
  # Uncomment the build line and specify the context and Dockerfile location
  build:
    context: ./airflow
    dockerfile: airflow.Dockerfile
  environment:
    &airflow-common-env
    AIRFLOW__CORE__EXECUTOR: CeleryExecutor
    AIRFLOW__DATABASE__SQL_ALCHEMY_CONN: postgresql+psycopg2://airflow:airflow@postgres/airflow
    # For backward compatibility, with Airflow <2.3
    AIRFLOW__CORE__SQL_ALCHEMY_CONN: postgresql+psycopg2://airflow:airflow@postgres/airflow
    AIRFLOW__CELERY__RESULT_BACKEND: db+postgresql://airflow:airflow@postgres/airflow
    AIRFLOW__CELERY__BROKER_URL: redis://:@redis:6379/0
    AIRFLOW__CORE__FERNET_KEY: ''
    AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION: 'true'
    AIRFLOW__CORE__LOAD_EXAMPLES: 'false'
    AIRFLOW__API__AUTH_BACKENDS: 'airflow.api.auth.backend.basic_auth,airflow.api.auth.backend.session'
    # yamllint disable rule:line-length
    # Use simple http server on scheduler for health checks
    # See https://airflow.apache.org/docs/apache-airflow/stable/administration-and-deployment/logging-monitoring/check-health.html#scheduler-health-check-server
    # yamllint enable rule:line-length
    AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK: 'true'
    # WARNING: Use _PIP_ADDITIONAL_REQUIREMENTS option ONLY for a quick checks
    # for other purpose (development, test and especially production usage) build/extend Airflow image.
    _PIP_ADDITIONAL_REQUIREMENTS: ${_PIP_ADDITIONAL_REQUIREMENTS:-}
    BEA_API_KEY: "8AF622DE-FDFE-4765-B075-E572B57B64BE"  # Add your API key here
    POSTGRES_HOST: "postgres"
    POSTGRES_PORT: "5432"
    POSTGRES_DB: "airflow"
    POSTGRES_USER: "airflow"
    POSTGRES_PASSWORD: "airflow"
  volumes:
    - ${AIRFLOW_PROJ_DIR:-.}/dags:/opt/airflow/dags
    - ${AIRFLOW_PROJ_DIR:-.}/logs:/opt/airflow/logs
    - ${AIRFLOW_PROJ_DIR:-.}/config:/opt/airflow/config
    - ${AIRFLOW_PROJ_DIR:-.}/plugins:/opt/airflow/plugins
    - ${AIRFLOW_PROJ_DIR:-.}/packages:/opt/airflow/packages  # Adding for Dag Package Access
    - ${AIRFLOW_PROJ_DIR:-.}/stream_configs:/opt/airflow/stream_configs  # Ensure this line is present
    - ./dbt:/opt/dbt


  user: "${AIRFLOW_UID:-50000}:0"
  depends_on:
    &airflow-common-depends-on
    redis:
      condition: service_healthy
    postgres:
      condition: service_healthy

services:
  postgres:
    image: postgres:latest
    environment:
      POSTGRES_USER: airflow
      POSTGRES_PASSWORD: airflow
      POSTGRES_DB: airflow
    volumes:
      - postgres-db-volume:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD", "pg_isready", "-U", "airflow"]
      interval: 10s
      retries: 5
      start_period: 5s
    restart: always
    ports:
      - "5432:5432"
      

  redis:
    image: redis:latest
    expose:
      - 6379
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 30s
      retries: 50
      start_period: 30s
    restart: always

  airflow-webserver:
    <<: *airflow-common
    command: webserver
    ports:
      - "8080:8080"
    healthcheck:
      test: ["CMD", "curl", "--fail", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    restart: always
    depends_on:
      <<: *airflow-common-depends-on
      airflow-init:
        condition: service_completed_successfully

  airflow-scheduler:
    <<: *airflow-common
    command: scheduler
    healthcheck:
      test: ["CMD", "curl", "--fail", "http://localhost:8974/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    restart: always
    depends_on:
      <<: *airflow-common-depends-on
      airflow-init:
        condition: service_completed_successfully

  airflow-worker:
    <<: *airflow-common
    command: celery worker
    healthcheck:
      test:
        - "CMD-SHELL"
        - 'celery --app airflow.executors.celery_executor.app inspect ping -d "celery@$${HOSTNAME}"'
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    environment:
      <<: *airflow-common-env
      # Required to handle warm shutdown of the celery workers properly
      # See https://airflow.apache.org/docs/docker-stack/entrypoint.html#signal-propagation
      DUMB_INIT_SETSID: "0"
    restart: always
    depends_on:
      <<: *airflow-common-depends-on
      airflow-init:
        condition: service_completed_successfully

  airflow-triggerer:
    <<: *airflow-common
    command: triggerer
    healthcheck:
      test: ["CMD-SHELL", 'airflow jobs check --job-type TriggererJob --hostname "$${HOSTNAME}"']
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    restart: always
    depends_on:
      <<: *airflow-common-depends-on
      airflow-init:
        condition: service_completed_successfully

  airflow-init:
    <<: *airflow-common
    entrypoint: /bin/bash
    # yamllint disable rule:line-length
    command:
      - -c
      - |
        function ver() {
          printf "%04d%04d%04d%04d" $${1//./ }
        }
        # Ensure gosu is available
        apt-get update && apt-get install -y gosu && rm -rf /var/lib/apt/lists/*
        # Fetch Airflow version using gosu to ensure it runs under the right user context
        airflow_version=$$(gosu airflow airflow version)
        airflow_version_comparable=$$(ver $$airflow_version)
        min_airflow_version=2.2.0
        min_airflow_version_comparable=$$(ver $$min_airflow_version)
        echo "Detected Airflow version: $$airflow_version"
        if (( $$airflow_version_comparable < $$min_airflow_version_comparable )); then
          echo -e "\033[1;31mERROR!!!: Too old Airflow version $$airflow_version!\e[0m"
          echo "The minimum Airflow version supported: $$min_airflow_version. Only use this or higher!"
          exit 1
        fi
        if [[ -z "${AIRFLOW_UID}" ]]; then
          echo
          echo -e "\033[1;33mWARNING!!!: AIRFLOW_UID not set!\e[0m"
          echo "If you are on Linux, you SHOULD follow the instructions below to set "
          echo "AIRFLOW_UID environment variable, otherwise files will be owned by root."
          echo "For other operating systems you can get rid of the warning with manually created .env file:"
          echo "    See: https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html#setting-the-right-airflow-user"
          echo
        fi
        one_meg=1048576
        mem_available=$$(($$(getconf _PHYS_PAGES) * $$(getconf PAGE_SIZE) / one_meg))
        cpus_available=$$(grep -cE 'cpu[0-9]+' /proc/stat)
        disk_available=$$(df / | tail -1 | awk '{print $$4}')
        warning_resources="false"
        if (( mem_available < 4000 )) ; then
          echo
          echo -e "\033[1;33mWARNING!!!: Not enough memory available for Docker.\e[0m"
          echo "At least 4GB of memory required. You have $$(numfmt --to iec $$((mem_available * one_meg)))"
          echo
          warning_resources="true"
        fi
        if (( cpus_available < 2 )); then
          echo
          echo -e "\033[1;33mWARNING!!!: Not enough CPUS available for Docker.\e[0m"
          echo "At least 2 CPUs recommended. You have $${cpus_available}"
          echo
          warning_resources="true"
        fi
        if (( disk_available < one_meg * 10 )); then
          echo
          echo -e "\033[1;33mWARNING!!!: Not enough Disk space available for Docker.\e[0m"
          echo "At least 10 GBs recommended. You have $$(numfmt --to iec $$((disk_available * 1024 )))"
          echo
          warning_resources="true"
        fi
        if [[ $${warning_resources} == "true" ]]; then
          echo
          echo -e "\033[1;33mWARNING!!!: You have not enough resources to run Airflow (see above)!\e[0m"
          echo "Please follow the instructions to increase amount of resources available:"
          echo "   https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html#before-you-begin"
          echo
        fi
        mkdir -p /sources/logs /sources/dags /sources/plugins
        chown -R "${AIRFLOW_UID}:0" /sources/{logs,dags,plugins}
        exec /entrypoint airflow version
    # yamllint enable rule:line-length
    environment:
      <<: *airflow-common-env
      _AIRFLOW_DB_UPGRADE: 'true'
      _AIRFLOW_WWW_USER_CREATE: 'true'
      _AIRFLOW_WWW_USER_USERNAME: ${_AIRFLOW_WWW_USER_USERNAME:-airflow}
      _AIRFLOW_WWW_USER_PASSWORD: ${_AIRFLOW_WWW_USER_PASSWORD:-airflow}
      _PIP_ADDITIONAL_REQUIREMENTS: ''
    user: "0:0"
    volumes:
      - ${AIRFLOW_PROJ_DIR:-.}:/sources

  airflow-cli:
    <<: *airflow-common
    profiles:
      - debug
    environment:
      <<: *airflow-common-env
      CONNECTION_CHECK_MAX_COUNT: "0"
    # Workaround for entrypoint issue. See: https://github.com/apache/airflow/issues/16252
    command:
      - bash
      - -c
      - airflow

  # You can enable flower by adding "--profile flower" option e.g. docker-compose --profile flower up
  # or by explicitly targeted on the command line e.g. docker-compose up flower.
  # See: https://docs.docker.com/compose/profiles/
  flower:
    <<: *airflow-common
    command: celery flower
    profiles:
      - flower
    ports:
      - "5555:5555"
    healthcheck:
      test: ["CMD", "curl", "--fail", "http://localhost:5555/"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 30s
    restart: always
    depends_on:
      <<: *airflow-common-depends-on
      airflow-init:
        condition: service_completed_successfully
  
  # Streamlit web app
  web:
    build:
      context: ./web
      dockerfile: Dockerfile
    ports:
      - "8501:8501"  # Streamlit's default port
    volumes:
      - ./web:/usr/src/app
    env_file:
      - .env  # Ensure this line is present to load the .env file
    depends_on:
      - postgres
      
volumes:
  postgres-db-volume:

================
File: Makefile
================
.PHONY: build up down dbt-run dbt-test load-data db-init airflow-init all build-web run-web

# Build the Docker containers
build:
	docker-compose build

# Bring up the Docker containers
up:
	docker-compose up -d

# Take down the Docker containers
down:
	docker-compose down

# Run DBT tasks
dbt-run:
	docker-compose run dbt dbt run

# Test DBT models
dbt-test:
	docker-compose run dbt dbt test

# Load initial data to the database
load-data:
	docker-compose run web python scripts/process_data.py

# Initialize or reset the database (optional command)
db-init:
	docker-compose run web python scripts/init_db.py

# Initialize Airflow
airflow-init:
	docker-compose up airflow-init

# Full setup sequence
all: build airflow-init up

# Build the Docker container for the web application
build-web:
	docker-compose build web

# Run the web application
run-web:
	docker-compose up -d web

================
File: README.md
================
# Airflow and PostgreSQL Data Pipeline

This project sets up a data pipeline using Apache Airflow and PostgreSQL to fetch and process data from the BEA (Bureau of Economic Analysis) API and load it into a PostgreSQL database. The setup includes Docker containers for Airflow, PostgreSQL, and Redis.

## Prerequisites

- Docker
- Docker Compose

## Getting Started

### 1. Clone the Repository

```bash
git clone <repository-url>
cd <repository-directory>
```

### 2. Set Up Environment Variables

Create a .env file in the root of the project and add the following environment variables:


- AIRFLOW_IMAGE_NAME=apache/airflow:2.6.1
- AIRFLOW_UID=50000
- AIRFLOW_PROJ_DIR=.
- BEA_API_KEY=<your_bea_api_key>
- POSTGRES_HOST=postgres
- POSTGRES_PORT=5432
- POSTGRES_DB=airflow
- POSTGRES_USER=airflow
- POSTGRES_PASSWORD=airflow

### 3. Build and Start the Docker Containers

Use the provided Makefile to manage Docker containers:

```bash
# Build the Docker containers
make build

# Initialize Airflow
make airflow-init

# Bring up the Docker containers
make up
```


### 4. Initialize or Reset the Database (Optional)

If you need to initialize or reset the database, you can run:

```bash
make db-init
```

#### Makefile Commands

The Makefile includes the following commands:

- build: Build the Docker containers
- up: Bring up the Docker containers
- down: Take down the Docker containers
- dbt-run: Run DBT tasks
- dbt-test: Test DBT models
- load-data: Load initial data to the database
- db-init: Initialize or reset the database
- airflow-init: Initialize Airflow
- all: Full setup sequence (build, initialize Airflow, and bring up containers)
- Docker Compose Configuration


The docker-compose.yml file sets up the following services:

- PostgreSQL: Database service for Airflow and data storage
- Redis: Broker service for Airflow CeleryExecutor
- Airflow Webserver: Airflow web UI
- Airflow Scheduler: Airflow scheduler
- Airflow Worker: Airflow worker for executing tasks
- Airflow Triggerer: Airflow triggerer for managing deferred tasks
- Airflow Init: Service to initialize the Airflow database and create an admin user
- Volumes
- postgres-db-volume: Persistent volume for PostgreSQL data

Environment Variables
- AIRFLOW__CORE__EXECUTOR: Set to CeleryExecutor
- AIRFLOW__DATABASE__SQL_ALCHEMY_CONN: SQLAlchemy connection string for PostgreSQL
- AIRFLOW__CELERY__RESULT_BACKEND: Result backend for Celery
- AIRFLOW__CELERY__BROKER_URL: Broker URL for Celery
- AIRFLOW__CORE__FERNET_KEY: Encryption key for sensitive data
- AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION: Whether DAGs are paused at creation
- AIRFLOW__CORE__LOAD_EXAMPLES: Whether to load example DAGs
- AIRFLOW__API__AUTH_BACKENDS: Authentication backends for Airflow API
- AIRFLOW__SCHEDULER__ENABLE_HEALTH_CHECK: Enable health check for scheduler
- BEA_API_KEY: API key for the BEA API
- POSTGRES_HOST: Hostname for PostgreSQL
- POSTGRES_PORT: Port for PostgreSQL
- POSTGRES_DB: Database name for PostgreSQL
- POSTGRES_USER: Username for PostgreSQL
- POSTGRES_PASSWORD: Password for PostgreSQL

#### DAG Configuration
The sync_bea_dag DAG fetches data from the BEA API and loads it into the PostgreSQL database.

Tasks

sync_bea: Fetches data from the BEA API and loads it into the PostgreSQL database using the BEAApiClient class.

Airflow Variables
- BEA_API_KEY: API key for the BEA API
- POSTGRES_HOST: Hostname for PostgreSQL
- POSTGRES_PORT: Port for PostgreSQL
- POSTGRES_DB: Database name for PostgreSQL
- POSTGRES_USER: Username for PostgreSQL
- POSTGRES_PASSWORD: Password for PostgreSQL

#### BEAApiClient Class

The BEAApiClient class handles fetching data from the BEA API and loading it into the PostgreSQL database. It uses the PostgresDatabase class to interact with the database.

Methods
- load_config: Loads the BEA dataset configurations from a YAML file.
- get_parameter_list: Retrieves a list of parameters for a specific dataset from the BEA API.
- get_parameter_values: Retrieves valid values for a specific parameter of a dataset.
- fetch_all_dataset_parameters: Fetches parameters for all datasets.
- fetch_valid_table_names: Fetches and displays valid table names for datasets.
- determine_frequency: Determines the frequency of data retrieval.
- check_rate_limit: Checks and handles the rate limit for the BEA API.
- get_data: Fetches data from the BEA API.
- sync_datasets: Syncs datasets from the BEA API to the PostgreSQL database.
- load_into_postgres: Loads data into the PostgreSQL database using the insert_data_with_copy method from PostgresDatabase.

#### PostgresDatabase Class

The PostgresDatabase class provides methods to interact with the PostgreSQL database.

Methods
- _create_engine: Creates a SQLAlchemy engine.
- fetch_data: Fetches data from the database.
- execute_query: Executes a SQL query.
- insert_data: Inserts data into a table using pandas to_sql.
- insert_data_with_copy: Inserts data into a table using the COPY command.
- create_table_if_not_exists: Creates a table if it does not exist.
- get_postgres_type: Maps pandas data types to PostgreSQL data types.
- create_schema: Creates a schema if it does not exist.


#### DBT Data Warehousing
Setup
Running DBT Tasks

#### Machine Learning and Analysis
TODOs
